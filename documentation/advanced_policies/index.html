
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../img/ORB-logo-ring.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Orb Policy Reference - Orb Dynamic Edge Observability</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Montserrat";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-XYK19RRHLW"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&gtag("event","search",{search_term:this.value})}),"undefined"!=typeof location$&&location$.subscribe(function(e){gtag("config","G-XYK19RRHLW",{page_path:e.pathname})})})</script>
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-XYK19RRHLW"></script>


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#orb-policy-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!--
  Copyright (c) 2016-2022 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Determine class according to configuration -->


  


<!-- Header -->
<header class="md-header md-header--lifted" data-md-component="header">
  <nav
    class="md-header__inner md-grid"
    aria-label="Header"
  >

    <!-- Link to home -->
    <a
      href="../.."
      title="Orb Dynamic Edge Observability"
      class="md-header__button md-logo"
      aria-label="Orb Dynamic Edge Observability"
      data-md-component="logo"
    >
      <!-- Logo -->

  <img src="../../img/orb_logo_original.png" class="orb-logo" alt="logo" />

    </a>

    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>

    <!-- Header title -->
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Orb Dynamic Edge Observability
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Orb Policy Reference
            
          </span>
        </div>
      </div>
    </div>

    <!-- Color palette -->
    

    <!-- Site language selector -->
    
    <!-- Navigation tabs (sticky) -->
    
    
    
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../about/" class="md-tabs__link">
      About
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../getting_started/" class="md-tabs__link">
      Getting Started
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../guides/" class="md-tabs__link">
        Guides
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../running_orb_agent/" class="md-tabs__link md-tabs__link--active">
        Documentation
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../contact/" class="md-tabs__link">
      Community
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
    

    <!-- Button to open search modal -->
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>

      <!-- Search interface -->
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    

    <!-- Repository information -->
    
      <div class="md-header__source">
        <a href="https://github.com/orb-community/orb" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    orb-community/orb
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Orb Dynamic Edge Observability" class="md-nav__button md-logo" aria-label="Orb Dynamic Edge Observability" data-md-component="logo">
      <!-- Logo -->

  <img src="../../img/orb_logo_original.png" class="orb-logo" alt="logo" />

    </a>
    Orb Dynamic Edge Observability
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/orb-community/orb" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    orb-community/orb
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../guides/">Guides</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" aria-label="Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/edge_networks/" class="md-nav__link">
        Edge Networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/authoritative_dns/" class="md-nav__link">
        Authoritative DNS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/recursive_dns/" class="md-nav__link">
        Recursive DNS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/dhcp_services/" class="md-nav__link">
        DHCP Services
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/flow/" class="md-nav__link">
        Network Traffic (Flow)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/response_testing/" class="md-nav__link">
        Response Testing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_5">
          Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Documentation" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../running_orb_agent/" class="md-nav__link">
        Running Orb Agents
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../orb_agent_configs/" class="md-nav__link">
        Configuring Orb Agent
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Orb Policy Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Orb Policy Reference
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pktvisor-policy" class="md-nav__link">
    Pktvisor policy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-section" class="md-nav__link">
    Input section
  </a>
  
    <nav class="md-nav" aria-label="Input section">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-input-structure" class="md-nav__link">
    Default input structure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#config-section" class="md-nav__link">
    Config section
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kind-section" class="md-nav__link">
    Kind section
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#handlers-section-analysis" class="md-nav__link">
    Handlers section (Analysis)
  </a>
  
    <nav class="md-nav" aria-label="Handlers section (Analysis)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abstract-configurations" class="md-nav__link">
    Abstract Configurations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-analyzer-dns" class="md-nav__link">
    DNS Analyzer (dns)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-l2-l3-analyzer-net" class="md-nav__link">
    Network (L2-L3) Analyzer (net)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhcp-analyzer-dhcp" class="md-nav__link">
    DHCP Analyzer (dhcp)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgp-analyzer-bgp" class="md-nav__link">
    BGP Analyzer (bgp)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packet-capture-analyzer-pcap" class="md-nav__link">
    Packet Capture Analyzer (pcap)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flow-analyzer-flow-beta" class="md-nav__link">
    Flow Analyzer (flow) [BETA]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netprobe-beta" class="md-nav__link">
    Netprobe [BETA]
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pktvisor_metrics/" class="md-nav__link">
        Orb Metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        Installing Orb control plane
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api/orb_rest_api/" class="md-nav__link">
        Orb REST API
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contact/" class="md-nav__link">
        Community
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pktvisor-policy" class="md-nav__link">
    Pktvisor policy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#input-section" class="md-nav__link">
    Input section
  </a>
  
    <nav class="md-nav" aria-label="Input section">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-input-structure" class="md-nav__link">
    Default input structure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#config-section" class="md-nav__link">
    Config section
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kind-section" class="md-nav__link">
    Kind section
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#handlers-section-analysis" class="md-nav__link">
    Handlers section (Analysis)
  </a>
  
    <nav class="md-nav" aria-label="Handlers section (Analysis)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abstract-configurations" class="md-nav__link">
    Abstract Configurations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-analyzer-dns" class="md-nav__link">
    DNS Analyzer (dns)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#network-l2-l3-analyzer-net" class="md-nav__link">
    Network (L2-L3) Analyzer (net)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhcp-analyzer-dhcp" class="md-nav__link">
    DHCP Analyzer (dhcp)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bgp-analyzer-bgp" class="md-nav__link">
    BGP Analyzer (bgp)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#packet-capture-analyzer-pcap" class="md-nav__link">
    Packet Capture Analyzer (pcap)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flow-analyzer-flow-beta" class="md-nav__link">
    Flow Analyzer (flow) [BETA]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netprobe-beta" class="md-nav__link">
    Netprobe [BETA]
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="orb-policy-reference">Orb Policy Reference</h1>
<p>The policy model has seven top level sections: <code>name</code>, <code>desciption</code>, <code>tags</code>, <code>backend</code>, <code>schema_version</code>, <code>policy</code> and <code>format</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<span class="w">    </span><span class="nt">&quot;backend&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;schema_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;policy&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th align="center">Policy Sections</th>
<th align="center">Default</th>
<th align="center">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>name</code></td>
<td align="center">-</td>
<td align="center">✅</td>
</tr>
<tr>
<td align="center"><code>backend</code></td>
<td align="center">-</td>
<td align="center">✅</td>
</tr>
<tr>
<td align="center"><code>policy</code></td>
<td align="center">-</td>
<td align="center">✅</td>
</tr>
<tr>
<td align="center"><code>description</code></td>
<td align="center"><em>None</em></td>
<td align="center">❌</td>
</tr>
<tr>
<td align="center"><code>tags</code></td>
<td align="center"><em>None</em></td>
<td align="center">❌</td>
</tr>
<tr>
<td align="center"><code>schema_version</code></td>
<td align="center"><em>1.0</em></td>
<td align="center">❌</td>
</tr>
<tr>
<td align="center"><code>format</code></td>
<td align="center"><em>json</em></td>
<td align="center">❌</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Name</strong><br><br>
Policy name must be unique, must start with a letter and contain only letters, numbers, <code>"-"</code> or <code>"_"</code>.</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Examples</p>
<div class="admonition success">
<p class="admonition-title">Success</p>
<p>"name": "my_policy" <br>
"name": "MY-policy_2</p>
</div>
<div class="admonition failure">
<p class="admonition-title">Failure</p>
<p>"name": "1_policy" <br>
"name": "MY-policy/2</p>
</div>
</div>
<ul>
<li>
<p><strong>Description</strong><br><br>
Policy description is a free string. You can describe using spaces, letters, numbers and special characters.<br><br></p>
</li>
<li>
<p><strong>Tags</strong><br><br>
Tags are intended to facilitate organization and are a dict type. </p>
</li>
</ul>
<p>The <code>tags</code> usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">&quot;tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">&quot;key1&quot;</span><span class="p">:</span><span class="s2">&quot;value1&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;key2&quot;</span><span class="p">:</span><span class="s2">&quot;value2&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;key3&quot;</span><span class="p">:</span><span class="s2">&quot;value3&quot;</span><span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<ul>
<li>
<p><strong>Backend</strong><br><br>
Backend determine to which backend the policy will be attached. Check the available backends <a href="/documentation/orb_agent_configs/#backends">here</a>. <br><br></p>
</li>
<li>
<p><strong>Schema version</strong><br><br>
Each backend supported on Orb must have a policy schema to be validated, parsed and applied. <code>schema_version</code> is the field responsible for allowing different schema versions and backward compatibility. Default should be "1.0".<br><br></p>
</li>
<li>
<p><strong>Format</strong><br><br>
The <code>format</code> specifies in which format the policy data will be written. The options are <code>json</code> and <code>yaml</code>. <code>json</code> is the default value.<br><br></p>
</li>
<li>
<p><strong>Policy</strong><br><br>
Each supported backend has specific structures for its policy data. Check the available options below.</p>
</li>
</ul>
<h2 id="pktvisor-policy">Pktvisor policy</h2>
<p>The policy data for pktvisor can be written in either YAML or JSON, and has four top level sections: “input”, “handlers”, "config" and “kind”.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">YAML</label><label for="__tabbed_3_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">input</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">..</span>
<span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
<span class="nt">handlers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">       </span>
<span class="w">   </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;collection&quot;</span>
<span class="w">   </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">        </span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="input-section">Input section</h2>
<p>The input section specifies what data streams the policy will be using for analysis, in other words, this specifies what data the agent should be listening in on, and is defined at the <a href="/documentation/orb_agent_configs/#pktvisor-configuration">agent level</a>. <br><br>
<span style="color:blue">Required fields:</span><br>
<code>input_type</code> - the type of input.  This field will be validated with the type of tap indicated by the <code>tap</code> parameter or by the <code>tap selector</code> . If the types are incompatible, the policy will fail.<br></p>
<p><code>tap</code> - the name given to this input in the tap/agent configuration  or <code>tap_selector</code> -  tags to match existing agent <a href="/documentation/orb_agent_configs/#pktvisor-configuration">taps</a>.
If <code>tap_selector</code> is used, it can be chosen whether taps with any of the tags or with all tags will be attached.</p>
<p><span style="color:blue">Optional fields:</span><br>
<code>filter</code> - to specify what data to include from the input <br>
<code>config</code> -  how the input will be used</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Every configuration set at the input can be reset at the tap level, with the one set on the tap dominant over the one set on the input.<br></p>
</div>
<h3 id="default-input-structure">Default input structure</h3>
<p><em>Using specific tap (<a href="#DnsPolicyExample">check the application in a policy here</a>):</em></p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">YAML</label><label for="__tabbed_4_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tap</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tap_name</span>
<span class="w">  </span><span class="nt">input_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type_of_input</span>
<span class="w">  </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bpf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;tap&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tap_name&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;type_of_input&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;bpf&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><em>or using tap selector matching any (<a href="#NetPolicyExample">check the application in a policy here</a>):</em></p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">YAML</label><label for="__tabbed_5_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tap_selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">any</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value2</span>
<span class="w">  </span><span class="nt">input_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type_of_input</span>
<span class="w">  </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bpf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;tap_selector&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;any&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;key1&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value1&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;key2&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value2&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;type_of_input&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;bpf&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><em>or using tap selector matching all (<a href="#DhcpPolicyExample">check the application in a policy here</a>):</em></p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">YAML</label><label for="__tabbed_6_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tap_selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">all</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value2</span>
<span class="w">  </span><span class="nt">input_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">type_of_input</span>
<span class="w">  </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bpf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;tap_selector&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;key1&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value1&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;key2&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value2&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;type_of_input&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;bpf&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="config-section">Config section</h2>
<p>There is the possibility of defining settings on the policy level. Currently, the only configuration available is the <code>merge_like_handlers</code>. </p>
<table>
<thead>
<tr>
<th align="center">Policy Configuration</th>
<th align="center">Type</th>
<th align="center">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>merge_like_handlers</code></td>
<td align="center"><em>bool</em></td>
<td align="center">false</td>
</tr>
</tbody>
</table>
<h4 id="merge_like_handlers">merge_like_handlers</h4>
<p>When <code>merge_like_handlers</code> config is true, metrics from all handlers of the same type are scraped together. This is useful when the <a href="#input-section">tap_selector</a> is used, as, by default, metrics are generated separately for each tap in the policy and this can be very expensive, depending on the number of taps.</p>
<p>The <code>merge_like_handlers</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">YAML</label><label for="__tabbed_7_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">config</span><span class="p">:</span>
<span class="w">  </span><span class="nt">merge_like_handlers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;merge_like_handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="kind-section">Kind section</h2>
<p>What kind of object you want to create
The only option for now is <code>"collection"</code>.</p>
<h2 id="handlers-section-analysis">Handlers section (Analysis)</h2>
<p>Handlers are the modules responsible for extracting metrics from inputs. For each handler type, specific configuration, filters and group of metrics can be defined, and there are also configs (abstract configuration) that can be applied to all handlers: <br><br></p>
<p><strong>Default handler structure:</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">YAML</label><label for="__tabbed_8_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">handlers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">topn_percentile_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">  </span><span class="nt">modules</span><span class="p">:</span>
<span class="w">    </span><span class="nt">tap_name</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="nt">require_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="nt">filter</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="nt">metric_groups</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enable</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">....</span>
<span class="w">        </span><span class="nt">disable</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.....</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">......</span><span class="w">     </span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;topn_percentile_threshold&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;tap_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;require_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;metric_groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;...&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;....&quot;</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;disable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;.....&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;......&quot;</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br></p>
<p>To enable any metric group use the syntax:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">YAML</label><label for="__tabbed_9_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">metric_groups</span><span class="p">:</span>
<span class="w">  </span><span class="nt">enable</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">group_to_enable</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;metric_groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="s2">&quot;group_to_enable&quot;</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>To enable all available metric groups use the syntax:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">YAML</label><label for="__tabbed_10_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">metric_groups</span><span class="p">:</span>
<span class="w">  </span><span class="nt">enable</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;metric_groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="s2">&quot;all&quot;</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>In order to disable any metric group use the syntax:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">YAML</label><label for="__tabbed_11_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">metric_groups</span><span class="p">:</span>
<span class="w">  </span><span class="nt">disable</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">group_to_disable</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;metric_groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;disable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="s2">&quot;group_to_disable&quot;</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>To disable all metric groups use the syntax:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">YAML</label><label for="__tabbed_12_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">metric_groups</span><span class="p">:</span>
<span class="w">  </span><span class="nt">disable</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">all</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;metric_groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;disable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="s2">&quot;all&quot;</span>
<span class="w">    </span><span class="p">]</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<ul>
<li>Attention: enable is dominant over disable. So if both are passed, the metrics group will be enabled;</li>
</ul>
<h3 id="abstract-configurations">Abstract Configurations</h3>
<p>There are general configurations, which can be applied to all handlers. These settings can be reset for each module, within the specific module configs. In this case, the configuration inside the module will override the configuration passed in general handler. <br></p>
<table>
<thead>
<tr>
<th align="center">Abstract Configuration</th>
<th align="center">Type</th>
<th align="center">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a href="#deep_sample_rate"><code>deep_sample_rate</code></a></td>
<td align="center"><em>int</em></td>
<td align="center">100 (per second)</td>
</tr>
<tr>
<td align="center"><a href="#num_periods"><code>num_periods</code></a></td>
<td align="center"><em>int</em></td>
<td align="center">5</td>
</tr>
<tr>
<td align="center"><a href="#topn_count"><code>topn_count</code></a></td>
<td align="center"><em>int</em></td>
<td align="center">10</td>
</tr>
<tr>
<td align="center"><a href="#topn_percentile_threshold"><code>topn_percentile_threshold</code></a></td>
<td align="center"><em>int</em></td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p><strong>deep_sample_rate</strong> <a name="deep_sample_rate"></a><br>
<font size="1"><a href="#abstract-configurations">Back to Top - Abstract Configurations</a></font></p>
<p><code>deep_sample_rate</code> determines the number of data packets that will be analyzed deeply per second. Some metrics are operationally expensive to generate, such as metrics that require string parsing (qname2, qtype, etc.). For this reason, a maximum number of packets per second to be analyzed is determined. If in one second fewer packages than the maximum amount are transacted, all packages will compose the deep metrics sample, if there are more packages than the established one, the value of the variable will be used. Allowed values are in the range [1,100]. Default value is 100. <br></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a value less than 1 is passed, the <code>deep_sample_rate</code> will be 1. If the value passed is more than 100, <code>deep_sample_rate</code> will be 100.</p>
</div>
<p>The <code>deep_sample_rate</code> usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">YAML</label><label for="__tabbed_13_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">i</span><span class="kc">nt</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>num_periods</strong> <a name="num_periods"></a><br>
<font size="1"><a href="#abstract-configurations">Back to Top - Abstract Configurations</a></font></p>
<p><code>num_periods</code> determines the amount of minutes of data that will be available on the metrics endpoint. Allowed values are in the range [2,10]. Default value is 5. <br></p>
<p>The <code>num_periods</code> usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><input id="__tabbed_14_2" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">YAML</label><label for="__tabbed_14_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">i</span><span class="kc">nt</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>topn_count</strong> <a name="topn_count"></a><br>
<font size="1"><a href="#abstract-configurations">Back to Top - Abstract Configurations</a></font></p>
<p><code>topn_count</code> sets the maximum amount of elements displayed in top metrics. If there is less quantity than the configured value, the composite metrics will have the existing value. But if there are more metrics than the configured value, the variable will be actively limiting. Any positive integer is valid and the default value is 10. <br></p>
<p>The <code>topn_count</code> usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><input id="__tabbed_15_2" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">YAML</label><label for="__tabbed_15_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">i</span><span class="kc">nt</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>topn_percentile_threshold</strong> <a name="topn_percentile_threshold"></a><br>
<font size="1"><a href="#abstract-configurations">Back to Top - Abstract Configurations</a></font></p>
<p><code>topn_percentile_threshold</code> sets the threshold of data to be considered based on the percentiles, so allowed values are in the range [0,100].
The default value is 0, that is, all data is considered. If, for example, the value 10 is set, scraped topn metrics will only consider data from the 10th percentile, that is, data between the highest 90%.</p>
<p>The <code>topn_percentile_threshold</code> usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><input id="__tabbed_16_2" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">YAML</label><label for="__tabbed_16_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">topn_percentile_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;topn_percentile_threshold&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">i</span><span class="kc">nt</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="dns-analyzer-dns">DNS Analyzer (dns)</h3>
<ul>
<li><a href="#DnsPolicyExample">Example of policy</a></li>
<li><a href="#dnsv2_metrics_group">Metrics Group</a></li>
<li><a href="#dns_filters_v2">Filters</a></li>
<li><a href="#dns_configurations">Configurations</a></li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="17:2"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><input id="__tabbed_17_2" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1"> DNS(v2)</label><label for="__tabbed_17_2"> DNS(v1)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Status: <code>Beta</code>. The metric names and configuration options may still change</p>
</div>
<h6 id="example-of-policy-with-input-pcap-and-handler-dnsv2">Example of policy with input pcap and handler DNS(v2) <a name="DnsPolicyExample"></a></h6>
<div class="tabbed-set tabbed-alternate" data-tabs="18:2"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><input id="__tabbed_18_2" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">YAML</label><label for="__tabbed_18_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">handlers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">  </span><span class="nt">modules</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default_dns</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dns</span>
<span class="w">      </span><span class="nt">require_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2.0&quot;</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">public_suffix_list</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">        </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">        </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
<span class="w">        </span><span class="nt">topn_percentile_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">      </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">        </span><span class="nt">only_rcode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">        </span><span class="nt">only_dnssec_response</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">answer_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">        </span><span class="nt">only_qtype</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">only_qname_suffix</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;.google.com&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;.orb.live&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">geoloc_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">        </span><span class="nt">asn_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">        </span><span class="nt">dnstap_msg_type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;auth&quot;</span>
<span class="w">      </span><span class="nt">metric_groups</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enable</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cardinality</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">counters</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">quantiles</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_rcodes</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_qnames</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_qtypes</span>
<span class="w">        </span><span class="nt">disable</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_size</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_ports</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xact_times</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_ecs</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span>
<span class="w">  </span><span class="nt">tap</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default_pcap</span>
<span class="w">  </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bpf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp port 53</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">iface</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wlo1</span>
<span class="w">    </span><span class="nt">host_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.1.167/24</span>
<span class="w">    </span><span class="nt">pcap_source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libpcap</span>
<span class="w">    </span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">merge_like_handlers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;default_dns&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dns&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;require_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.0&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;public_suffix_list&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;topn_percentile_threshold&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;only_rcode&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;only_dnssec_response&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;answer_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;only_qtype&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="mi">1</span><span class="p">,</span>
<span class="w">            </span><span class="mi">2</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;only_qname_suffix&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;.google.com&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;.orb.live&quot;</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;geoloc_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;asn_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;dnstap_msg_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;auth&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;metric_groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;cardinality&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;counters&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;quantiles&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_rcodes&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_qnames&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_qtypes&quot;</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;disable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;top_size&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_ports&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;xact_times&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_ecs&quot;</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pcap&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tap&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default_pcap&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;bpf&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;udp port 53&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;iface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;wlo1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;host_spec&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.167/24&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;pcap_source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;libpcap&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;debug&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;merge_like_handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;collection&quot;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br></p>
<p><strong>Handler Type</strong>: "dns" <br></p>
<h4 id="metrics-group-check-the-dns-metrics-belonging-to-each-group">Metrics Group  - <font size="1"><a href="/documentation/pktvisor_metrics/#dns-metrics">Check the dns metrics belonging to each group</a></font><br> <a name="dnsv2_metrics_group"></a></h4>
<table>
<thead>
<tr>
<th align="center">Metric Group</th>
<th align="center">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>top_ecs</code></td>
<td align="center">disabled</td>
</tr>
<tr>
<td align="center"><code>top_ports</code></td>
<td align="center">disabled</td>
</tr>
<tr>
<td align="center"><code>top_size</code></td>
<td align="center">disabled</td>
</tr>
<tr>
<td align="center"><code>xact_times</code></td>
<td align="center">disabled</td>
</tr>
<tr>
<td align="center"><code>cardinality</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>counters</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>top_qnames</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>quantiles</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>top_qtypes</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>top_rcodes</code></td>
<td align="center">enabled</td>
</tr>
</tbody>
</table>
<h4 id="filters">Filters <a name="dns_filters_v2"></a><br></h4>
<table>
<thead>
<tr>
<th align="center">Filter</th>
<th align="center">Type</th>
<th align="center">Input</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a href="#only_rcode_v2"><code>only_rcode</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#exclude_noerror_v2"><code>exclude_noerror</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#only_dnssec_response_v2"><code>only_dnssec_response</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#answer_count_v2"><code>answer_count</code></a></td>
<td align="center"><em>int</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#only_qtype_v2"><code>only_qtype</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#only_qname_v2"><code>only_qname</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#only_qname_suffix_v2"><code>only_qname_suffix</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#geoloc_notfound_v2"><code>geoloc_notfound</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#asn_notfound_v2"><code>asn_notfound</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#only_xact_directions_type_v2"><code>only_xact_directions</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#dnstap_msg_type_v2"><code>dnstap_msg_type</code></a></td>
<td align="center"><em>str</em></td>
<td align="center">DNSTAP</td>
</tr>
</tbody>
</table>
<p><strong>only_rcode:</strong> <em>str[]</em>. <a name="only_rcode_v2"></a><br>
<font size="1"><a href="#dns_filters_v2">Back to DNS-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>When a DNS server returns a response to a query made, one of the properties of the response is the "response code" (rcode), a code that describes what happened to the query that was made. <br><br />
Most response codes indicate why the query failed and when the query succeeds, the return is an RCODE:0, whose name is NOERROR. <br>
Supported types are in the table below (if you use any other code that is not in the table below, your policy will fail): <br></p>
<table>
<thead>
<tr>
<th align="center">DNS response code</th>
<th align="center">Name</th>
<th align="center">Description</th>
<th align="center">Reference</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>0</code></td>
<td align="center">NOERROR</td>
<td align="center">No error condition</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc1035.html">[RFC1035]</a></td>
</tr>
<tr>
<td align="center"><code>1</code></td>
<td align="center">FORMERR</td>
<td align="center">Format error - The name server was unable to interpret the query.</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc1035.html">[RFC1035]</a></td>
</tr>
<tr>
<td align="center"><code>2</code></td>
<td align="center">SERVFAIL</td>
<td align="center">Server failure - The name server was unable to process this query due to a problem with the name server.</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc1035.html">[RFC1035]</a></td>
</tr>
<tr>
<td align="center"><code>3</code></td>
<td align="center">NXDOMAIN</td>
<td align="center">Name Error - Meaningful only for responses from an authoritative name server, this code signifies that the domain name referenced in the query does not exist.</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc1035.html">[RFC1035]</a></td>
</tr>
<tr>
<td align="center"><code>4</code></td>
<td align="center">NOTIMP</td>
<td align="center">Not Implemented - The name server does not support the requested kind of query.</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc1035.html">[RFC1035]</a></td>
</tr>
<tr>
<td align="center"><code>5</code></td>
<td align="center">REFUSED</td>
<td align="center">The name server refuses to perform the specified operation for  policy reasons.  For example, a name server may not wish to provide the information to the particular requester, or a name server may not wish to perform a particular operation (e.g., zone)</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc1035.html">[RFC1035]</a></td>
</tr>
<tr>
<td align="center"><code>6</code></td>
<td align="center">YXDOMAIN</td>
<td align="center">Name that should not exist, does exist</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2136.html">[RFC2136]</a></td>
</tr>
<tr>
<td align="center"><code>7</code></td>
<td align="center">YXRRSET</td>
<td align="center">RR set that should not exist, does exist</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2136.html">[RFC2136]</a></td>
</tr>
<tr>
<td align="center"><code>8</code></td>
<td align="center">NXRRSET</td>
<td align="center">RR Set that should exist, does not exist</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2136.html">[RFC2136]</a></td>
</tr>
<tr>
<td align="center"><code>9</code></td>
<td align="center">NOTAUTH</td>
<td align="center">Server Not Authoritative for zone or Not Authorized</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2136.html">[RFC2136]</a></td>
</tr>
<tr>
<td align="center"><code>10</code></td>
<td align="center">NOTZONE</td>
<td align="center">Name not contained in zone</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2136.html">[RFC2136]</a></td>
</tr>
<tr>
<td align="center"><code>11</code></td>
<td align="center">DSOTYPENI</td>
<td align="center">DSO-TYPE Not Implemented</td>
<td align="center"><a href="https://www.iana.org/go/rfc8490">[RFC8490]</a></td>
</tr>
<tr>
<td align="center"><code>16</code></td>
<td align="center">BADVERS/BADSIG</td>
<td align="center">Bad OPT Version or TSIG Signature Failure</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc8945.html">[RFC8945]</a></td>
</tr>
<tr>
<td align="center"><code>17</code></td>
<td align="center">BADKEY</td>
<td align="center">Key not recognized</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc8945.html">[RFC8945]</a></td>
</tr>
<tr>
<td align="center"><code>18</code></td>
<td align="center">BADTIME</td>
<td align="center">Signature out of time window</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc8945.html">[RFC8945]</a></td>
</tr>
<tr>
<td align="center"><code>19</code></td>
<td align="center">BADMODE</td>
<td align="center">Bad TKEY Mode</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2930.html">[RFC2930]</a></td>
</tr>
<tr>
<td align="center"><code>20</code></td>
<td align="center">BADNAME</td>
<td align="center">Duplicate key name</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2930.html">[RFC2930]</a></td>
</tr>
<tr>
<td align="center"><code>21</code></td>
<td align="center">BADALG</td>
<td align="center">Algorithm not supported</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2930.html">[RFC2930]</a></td>
</tr>
<tr>
<td align="center"><code>22</code></td>
<td align="center">BADTRUNC</td>
<td align="center">Bad Truncation</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc8945.html">[RFC8945]</a></td>
</tr>
<tr>
<td align="center"><code>23</code></td>
<td align="center">BADCOOKIE</td>
<td align="center">Bad/missing Server Cookie</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc7873.html">[RFC7873]</a></td>
</tr>
</tbody>
</table>
<p>The <code>only_rcode</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:2"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><input id="__tabbed_19_2" name="__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="__tabbed_19_1">YAML</label><label for="__tabbed_19_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_rcode</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_rcode&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;int&quot;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>with the <code>int</code> referring to the response code to be filtered, written as string. <br></p>
<p>Example: <br>
If you want to filter only successful queries responses you should use (note that all that the query will be discarded and the result will be just the responses): <br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:2"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><input id="__tabbed_20_2" name="__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="__tabbed_20_1">YAML</label><label for="__tabbed_20_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_rcode</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;NXDOMAIN&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;2&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;only_rcode&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;NXDOMAIN&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;2&quot;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Important information is that only one response code is possible for each handler. So, in order to have multiple filters on the same policy, multiple handlers must be created, each with a rcode type.</p>
<p><strong>exclude_noerror:</strong> <em>bool</em> <a name="exclude_noerror_v2"></a><br>
<font size="1"><a href="#dns_filters_v2">Back to DNS-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>You may still want to filter out only responses with any kind of error. For this, there is the <code>exclude_noerror</code> filter, which removes from its results all responses that did not return any type of error.
The <code>exclude_noerror</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:2"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio" /><input id="__tabbed_21_2" name="__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="__tabbed_21_1">YAML</label><label for="__tabbed_21_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">exclude_noerror</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;exclude_noerror&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Attention: the filter of <code>exclude_noerror</code> is dominant in relation to the filter of only_rcode, that is, if the filter of <code>exclude_noerror</code> is true, even if the filter of only_rcode is set, the results will be composed only by responses without any type of error (all type of errors will be kept). <br></p>
<p><strong>only_dnssec_response:</strong> <em>bool</em> <a name="only_dnssec_response_v2"></a><br>
<font size="1"><a href="#dns_filters_v2">Back to DNS-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>When you make a DNS query, the response you get may have a DNSSEC signature, which authenticates that DNS records originate from an authorized sender, thus protecting DNS from falsified information. <br>
To filter only responses signed by an authorized sender, use:
The <code>only_dnssec_response</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="22:2"><input checked="checked" id="__tabbed_22_1" name="__tabbed_22" type="radio" /><input id="__tabbed_22_2" name="__tabbed_22" type="radio" /><div class="tabbed-labels"><label for="__tabbed_22_1">YAML</label><label for="__tabbed_22_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_dnssec_response</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;only_dnssec_response&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br>
<strong>answer_count:</strong> <em>int</em> <a name="answer_count_v2"></a><br>
<font size="1"><a href="#dns_filters_v2">Back to DNS-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>One of the properties present in the query message structure is <code>Answer RRs</code>, which is the count of entries in the responses section (RR stands for “resource record”). <br>
The number of answers in the query is always zero, as a query message has only questions and no answers, and when the server sends the answer to that query, the value is set to the amount of entries in the answers section. <br></p>
<p>The <code>answer_count</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="23:2"><input checked="checked" id="__tabbed_23_1" name="__tabbed_23" type="radio" /><input id="__tabbed_23_2" name="__tabbed_23" type="radio" /><div class="tabbed-labels"><label for="__tabbed_23_1">YAML</label><label for="__tabbed_23_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">answer_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;answer_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="err">i</span><span class="kc">nt</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>with the <code>int</code> referring to the desired amount of answer. <br>
Note that any value greater than zero that is defined will exclude queries from the results, since in queries the number of answers is always 0. <br>
As the answers count of queries is 0, whenever the value set for the answer_count is 0, both queries and responses will compose the result. <br></p>
<p>A special case is the concept of <code>NODATA</code>, which is one of the possible returns to a query made to a DNS server is known as. This happens when the query is successful (so rcode:0), but there is no data as a response, so the number of answers is 0. <br>
In this case, to have in the results only the cases of <code>NODATA</code>, that is, the responses, the filter must be used together with the filter <code>exclude_noerror</code>.</p>
<p>Important information is that only one answer_count is possible for each handler. So, in order to have multiple counts on the same policy, multiple handlers must be created, each with an amount of answers.</p>
<p><strong>only_qtype:</strong> <em>str[]</em> <a name="only_qtype_v2"></a><br>
<font size="1"><a href="#dns_filters_v2">Back to DNS-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>DNS record types are records that provide important information about a hostname or domain. Supported default types can be seen <a href="https://github.com/orb-community/pktvisor/blob/develop/libs/visor_dns/dns.h#L30">here</a>. <br></p>
<p>The <code>only_qtype</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="24:2"><input checked="checked" id="__tabbed_24_1" name="__tabbed_24" type="radio" /><input id="__tabbed_24_2" name="__tabbed_24" type="radio" /><div class="tabbed-labels"><label for="__tabbed_24_1">YAML</label><label for="__tabbed_24_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_qtype</span><span class="p">:</span><span class="w"> </span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_qtype&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;str&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>If you want to filter only IPV4 record types, for example, you should use: <br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="25:2"><input checked="checked" id="__tabbed_25_1" name="__tabbed_25" type="radio" /><input id="__tabbed_25_2" name="__tabbed_25" type="radio" /><div class="tabbed-labels"><label for="__tabbed_25_1">YAML</label><label for="__tabbed_25_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_qtype</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;A&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_qtype&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;A&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>or</p>
<div class="tabbed-set tabbed-alternate" data-tabs="26:2"><input checked="checked" id="__tabbed_26_1" name="__tabbed_26" type="radio" /><input id="__tabbed_26_2" name="__tabbed_26" type="radio" /><div class="tabbed-labels"><label for="__tabbed_26_1">YAML</label><label for="__tabbed_26_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_qtype</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_qtype&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="mi">1</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Multiple types are also supported and both queries and responses that have any of the values in the array will be considered.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="27:2"><input checked="checked" id="__tabbed_27_1" name="__tabbed_27" type="radio" /><input id="__tabbed_27_2" name="__tabbed_27" type="radio" /><div class="tabbed-labels"><label for="__tabbed_27_1">YAML</label><label for="__tabbed_27_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_qtype</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;A&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_qtype&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="mi">2</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;A&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br></p>
<p><strong>only_qname:</strong> <em>str[]</em> <a name="only_qname_v2"></a><br>
<font size="1"><a href="#dns_filters_v2">Back to DNS-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>The <code>only_qname</code> filters dns packets based on queries and responses whose names exactly matches the strings present in the array. <br>
The <code>only_qname</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="28:2"><input checked="checked" id="__tabbed_28_1" name="__tabbed_28" type="radio" /><input id="__tabbed_28_2" name="__tabbed_28" type="radio" /><div class="tabbed-labels"><label for="__tabbed_28_1">YAML</label><label for="__tabbed_28_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_qname</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_qname&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;str&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Examples:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="29:2"><input checked="checked" id="__tabbed_29_1" name="__tabbed_29" type="radio" /><input id="__tabbed_29_2" name="__tabbed_29" type="radio" /><div class="tabbed-labels"><label for="__tabbed_29_1">YAML</label><label for="__tabbed_29_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_qname</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.google.com</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.nsone.net</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_qname&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;www.google.com&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;.nsone.net&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br></p>
<p><strong>only_qname_suffix:</strong> <em>str[]</em> <a name="only_qname_suffix_v2"></a><br>
<font size="1"><a href="#dns_filters_v2">Back to DNS-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>The <code>only_qname_suffix</code> filters queries and responses whose endings (suffixes) of the names match the strings present in the array. <br>
The <code>only_qname_suffix</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="30:2"><input checked="checked" id="__tabbed_30_1" name="__tabbed_30" type="radio" /><input id="__tabbed_30_2" name="__tabbed_30" type="radio" /><div class="tabbed-labels"><label for="__tabbed_30_1">YAML</label><label for="__tabbed_30_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_qname_suffix</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_qname_suffix&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;str&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Examples:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="31:2"><input checked="checked" id="__tabbed_31_1" name="__tabbed_31" type="radio" /><input id="__tabbed_31_2" name="__tabbed_31" type="radio" /><div class="tabbed-labels"><label for="__tabbed_31_1">YAML</label><label for="__tabbed_31_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_qname_suffix</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.google.com</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_qname_suffix&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;.google.com&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>or</p>
<div class="tabbed-set tabbed-alternate" data-tabs="32:2"><input checked="checked" id="__tabbed_32_1" name="__tabbed_32" type="radio" /><input id="__tabbed_32_2" name="__tabbed_32" type="radio" /><div class="tabbed-labels"><label for="__tabbed_32_1">YAML</label><label for="__tabbed_32_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_qname_suffix</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">google.com</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.nsone.net</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_qname_suffix&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;google.com&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;.nsone.net&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br>
<strong>geoloc_notfound:</strong> <em>bool</em> <a name="geoloc_notfound_v2"></a><br>
<font size="1"><a href="#dns_filters_v2">Back to DNS-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>Based on ECS (EDNS Client Subnet) information, it is possible to determine the geolocation of where the query is being made. When the Subnet refers to a region found in the standard databases, the city, state and country (approximated) are returned. However, when based on the subnet it is not possible to determine the geolocation, a <code>not found</code> is returned. <br>
The <code>geoloc_notfound</code> filter only keeps responses whose geolocations were not found. <br>
The <code>geoloc_notfound</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="33:2"><input checked="checked" id="__tabbed_33_1" name="__tabbed_33" type="radio" /><input id="__tabbed_33_2" name="__tabbed_33" type="radio" /><div class="tabbed-labels"><label for="__tabbed_33_1">YAML</label><label for="__tabbed_33_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">geoloc_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;geoloc_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br>
<strong>asn_notfound:</strong> <em>bool</em> <a name="asn_notfound_v2"></a><br>
<font size="1"><a href="#dns_filters_v2">Back to DNS-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>Based on ECS (EDNS Client Subnet) information, it is possible to determine the ASN (Autonomous System Number). When the IP of the subnet belongs to some not known ASN in the standard databases, a <code>not found</code> is returned. <br>
The <code>asn_notfound</code> filter only keeps responses whose asn were not found. <br>
The <code>asn_notfound</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="34:2"><input checked="checked" id="__tabbed_34_1" name="__tabbed_34" type="radio" /><input id="__tabbed_34_2" name="__tabbed_34" type="radio" /><div class="tabbed-labels"><label for="__tabbed_34_1">YAML</label><label for="__tabbed_34_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">asn_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;asn_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br>
<strong>only_xact_directions:</strong> <em>str[]</em> <a name="only_xact_directions_type_v2"></a><br>
<font size="1"><a href="#dns_filters_v2">Back to DNS-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>Filters metrics according to the direction of the transaction. Options are: <code>in</code>, <code>out</code> and <code>unknown</code>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="35:2"><input checked="checked" id="__tabbed_35_1" name="__tabbed_35" type="radio" /><input id="__tabbed_35_2" name="__tabbed_35" type="radio" /><div class="tabbed-labels"><label for="__tabbed_35_1">YAML</label><label for="__tabbed_35_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="nt">only_xact_directions</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="nt">only_xact_directions</span><span class="p">:</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">in</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unknown</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_xact_directions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;str&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;str&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_xact_directions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;unknown&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></p>
</div>
</div>
</div>
<p><br>
<strong>dnstap_msg_type:</strong> <em>str</em> <a name="dnstap_msg_type_v2"></a><br>
<font size="1"><a href="#dns_filters_v2">Back to DNS-v2 filters list</a></font></p>
<p>Input: DNSTAP <br></p>
<p>With a dnstap protocol it is possible to know the type of message that must be resolved in the request to the server. This filter therefore allows you to filter by response types.
Supported message types are: <code>auth</code>, <code>resolver</code>, <code>client</code>, <code>forwarder</code>, <code>stub</code>, <code>tool</code> and <code>update</code>.</p>
<p>The <code>dnstap_msg_type</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="36:2"><input checked="checked" id="__tabbed_36_1" name="__tabbed_36" type="radio" /><input id="__tabbed_36_2" name="__tabbed_36" type="radio" /><div class="tabbed-labels"><label for="__tabbed_36_1">YAML</label><label for="__tabbed_36_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="nt">dnstap_msg_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="nt">dnstap_msg_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">auth</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;dnstap_msg_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;str&quot;</span>
<span class="p">}</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;dnstap_msg_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;auth&quot;</span>
<span class="p">}</span>
</code></pre></div></p>
</div>
</div>
</div>
<p><br></p>
</div>
<div class="tabbed-block">
<h6 id="example-of-policy-with-input-pcap-and-handler-dnsv1">Example of policy with input pcap and handler DNS(v1)</h6>
<div class="tabbed-set tabbed-alternate" data-tabs="37:2"><input checked="checked" id="__tabbed_37_1" name="__tabbed_37" type="radio" /><input id="__tabbed_37_2" name="__tabbed_37" type="radio" /><div class="tabbed-labels"><label for="__tabbed_37_1">YAML</label><label for="__tabbed_37_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">handlers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">  </span><span class="nt">modules</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default_dns</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dns</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">public_suffix_list</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">        </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">        </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
<span class="w">        </span><span class="nt">topn_percentile_threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">      </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">        </span><span class="nt">only_rcode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">        </span><span class="nt">only_dnssec_response</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">answer_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">        </span><span class="nt">only_qtype</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">only_qname_suffix</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;.google.com&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;.orb.live&quot;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">geoloc_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">        </span><span class="nt">asn_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">        </span><span class="nt">dnstap_msg_type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;auth&quot;</span>
<span class="w">      </span><span class="nt">metric_groups</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enable</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_ecs</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_qnames_details</span>
<span class="w">        </span><span class="nt">disable</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">histograms</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">quantiles</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cardinality</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">counters</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dns_transaction</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_qnames</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_ports</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span>
<span class="w">  </span><span class="nt">tap</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default_pcap</span>
<span class="w">  </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bpf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp port 53</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">iface</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wlo1</span>
<span class="w">    </span><span class="nt">host_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.1.167/24</span>
<span class="w">    </span><span class="nt">pcap_source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libpcap</span>
<span class="w">    </span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">merge_like_handlers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;default_dns&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dns&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;public_suffix_list&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;topn_percentile_threshold&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;only_rcode&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;only_dnssec_response&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;answer_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;only_qtype&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="mi">1</span><span class="p">,</span>
<span class="w">            </span><span class="mi">2</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;only_qname_suffix&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;.google.com&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;.orb.live&quot;</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;geoloc_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;asn_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;dnstap_msg_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;auth&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;metric_groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;top_ecs&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_qnames_details&quot;</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;disable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;cardinality&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;counters&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;dns_transaction&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_qnames&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_ports&quot;</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pcap&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tap&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default_pcap&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;bpf&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;udp port 53&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;iface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;wlo1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;host_spec&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.167/24&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;pcap_source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;libpcap&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;debug&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;merge_like_handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;collection&quot;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>Handler Type</strong>: "dns" <br></p>
<h4 id="metrics-group-check-the-dns-metrics-belonging-to-each-group_1">Metrics Group - <font size="1"><a href="/documentation/pktvisor_metrics/#dns-metrics">Check the dns metrics belonging to each group</a></font><br> <a name="dnsv1_metrics_group"></a></h4>
<table>
<thead>
<tr>
<th align="center">Metric Group</th>
<th align="center">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>top_ecs</code></td>
<td align="center">disabled</td>
</tr>
<tr>
<td align="center"><code>top_qnames_details</code></td>
<td align="center">disabled</td>
</tr>
<tr>
<td align="center"><code>histograms</code></td>
<td align="center">disabled</td>
</tr>
<tr>
<td align="center"><code>cardinality</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>counters</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>dns_transaction</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>top_qnames</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>top_ports</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>quantiles</code></td>
<td align="center">enabled</td>
</tr>
</tbody>
</table>
<h4 id="filters_1">Filters <a name="dns_filters_v1"></a><br></h4>
<table>
<thead>
<tr>
<th align="center">Filter</th>
<th align="center">Type</th>
<th align="center">Input</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a href="#only_rcode_v1"><code>only_rcode</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#exclude_noerror_v1"><code>exclude_noerror</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#only_dnssec_response_v1"><code>only_dnssec_response</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#answer_count_v1"><code>answer_count</code></a></td>
<td align="center"><em>int</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#only_qtype_v1"><code>only_qtype</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#only_qname_v1"><code>only_qname</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#only_qname_suffix_v1"><code>only_qname_suffix</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#geoloc_notfound_v1"><code>geoloc_notfound</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#asn_notfound_v1"><code>asn_notfound</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#only_queries_v1"><code>only_queries</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#only_responses_v1"><code>only_responses</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP</td>
</tr>
<tr>
<td align="center"><a href="#dnstap_msg_type_v1"><code>dnstap_msg_type</code></a></td>
<td align="center"><em>str</em></td>
<td align="center">DNSTAP</td>
</tr>
</tbody>
</table>
<p><strong>only_rcode:</strong> <em>str[]</em>. <a name="only_rcode_v1"></a><br>
<font size="1"><a href="#dns_filters_v1">Back to DNS-v1 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>When a DNS server returns a response to a query made, one of the properties of the response is the "response code" (rcode), a code that describes what happened to the query that was made. <br><br />
Most response codes indicate why the query failed and when the query succeeds, the return is an RCODE:0, whose name is NOERROR. <br>
Supported types are in the table below (if you use any other code that is not in the table below, your policy will fail): <br></p>
<table>
<thead>
<tr>
<th align="center">DNS response code</th>
<th align="center">Name</th>
<th align="center">Description</th>
<th align="center">Reference</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>0</code></td>
<td align="center">NOERROR</td>
<td align="center">No error condition</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc1035.html">[RFC1035]</a></td>
</tr>
<tr>
<td align="center"><code>1</code></td>
<td align="center">FORMERR</td>
<td align="center">Format error - The name server was unable to interpret the query.</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc1035.html">[RFC1035]</a></td>
</tr>
<tr>
<td align="center"><code>2</code></td>
<td align="center">SERVFAIL</td>
<td align="center">Server failure - The name server was unable to process this query due to a problem with the name server.</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc1035.html">[RFC1035]</a></td>
</tr>
<tr>
<td align="center"><code>3</code></td>
<td align="center">NXDOMAIN</td>
<td align="center">Name Error - Meaningful only for responses from an authoritative name server, this code signifies that the domain name referenced in the query does not exist.</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc1035.html">[RFC1035]</a></td>
</tr>
<tr>
<td align="center"><code>4</code></td>
<td align="center">NOTIMP</td>
<td align="center">Not Implemented - The name server does not support the requested kind of query.</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc1035.html">[RFC1035]</a></td>
</tr>
<tr>
<td align="center"><code>5</code></td>
<td align="center">REFUSED</td>
<td align="center">The name server refuses to perform the specified operation for  policy reasons.  For example, a name server may not wish to provide the information to the particular requester, or a name server may not wish to perform a particular operation (e.g., zone)</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc1035.html">[RFC1035]</a></td>
</tr>
<tr>
<td align="center"><code>6</code></td>
<td align="center">YXDOMAIN</td>
<td align="center">Name that should not exist, does exist</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2136.html">[RFC2136]</a></td>
</tr>
<tr>
<td align="center"><code>7</code></td>
<td align="center">YXRRSET</td>
<td align="center">RR set that should not exist, does exist</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2136.html">[RFC2136]</a></td>
</tr>
<tr>
<td align="center"><code>8</code></td>
<td align="center">NXRRSET</td>
<td align="center">RR Set that should exist, does not exist</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2136.html">[RFC2136]</a></td>
</tr>
<tr>
<td align="center"><code>9</code></td>
<td align="center">NOTAUTH</td>
<td align="center">Server Not Authoritative for zone or Not Authorized</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2136.html">[RFC2136]</a></td>
</tr>
<tr>
<td align="center"><code>10</code></td>
<td align="center">NOTZONE</td>
<td align="center">Name not contained in zone</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2136.html">[RFC2136]</a></td>
</tr>
<tr>
<td align="center"><code>11</code></td>
<td align="center">DSOTYPENI</td>
<td align="center">DSO-TYPE Not Implemented</td>
<td align="center"><a href="https://www.iana.org/go/rfc8490">[RFC8490]</a></td>
</tr>
<tr>
<td align="center"><code>16</code></td>
<td align="center">BADVERS/BADSIG</td>
<td align="center">Bad OPT Version or TSIG Signature Failure</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc8945.html">[RFC8945]</a></td>
</tr>
<tr>
<td align="center"><code>17</code></td>
<td align="center">BADKEY</td>
<td align="center">Key not recognized</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc8945.html">[RFC8945]</a></td>
</tr>
<tr>
<td align="center"><code>18</code></td>
<td align="center">BADTIME</td>
<td align="center">Signature out of time window</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc8945.html">[RFC8945]</a></td>
</tr>
<tr>
<td align="center"><code>19</code></td>
<td align="center">BADMODE</td>
<td align="center">Bad TKEY Mode</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2930.html">[RFC2930]</a></td>
</tr>
<tr>
<td align="center"><code>20</code></td>
<td align="center">BADNAME</td>
<td align="center">Duplicate key name</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2930.html">[RFC2930]</a></td>
</tr>
<tr>
<td align="center"><code>21</code></td>
<td align="center">BADALG</td>
<td align="center">Algorithm not supported</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc2930.html">[RFC2930]</a></td>
</tr>
<tr>
<td align="center"><code>22</code></td>
<td align="center">BADTRUNC</td>
<td align="center">Bad Truncation</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc8945.html">[RFC8945]</a></td>
</tr>
<tr>
<td align="center"><code>23</code></td>
<td align="center">BADCOOKIE</td>
<td align="center">Bad/missing Server Cookie</td>
<td align="center"><a href="https://www.rfc-editor.org/rfc/rfc7873.html">[RFC7873]</a></td>
</tr>
</tbody>
</table>
<p>The <code>only_rcode</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="38:2"><input checked="checked" id="__tabbed_38_1" name="__tabbed_38" type="radio" /><input id="__tabbed_38_2" name="__tabbed_38" type="radio" /><div class="tabbed-labels"><label for="__tabbed_38_1">YAML</label><label for="__tabbed_38_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_rcode</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_rcode&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;int&quot;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>with the <code>int</code> referring to the response code to be filtered, written as string. <br></p>
<p>Example: <br>
If you want to filter only successful queries responses you should use (note that all that the query will be discarded and the result will be just the responses): <br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="39:2"><input checked="checked" id="__tabbed_39_1" name="__tabbed_39" type="radio" /><input id="__tabbed_39_2" name="__tabbed_39" type="radio" /><div class="tabbed-labels"><label for="__tabbed_39_1">YAML</label><label for="__tabbed_39_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">only_rcode</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;NXDOMAIN&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;2&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;only_rcode&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;NXDOMAIN&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;2&quot;</span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>Important information is that only one response code is possible for each handler. So, in order to have multiple filters on the same policy, multiple handlers must be created, each with a rcode type.</p>
<p><strong>exclude_noerror:</strong> <em>bool</em> <a name="exclude_noerror_v1"></a><br>
<font size="1"><a href="#dns_filters_v1">Back to DNS-v1 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>The <code>exclude_noerror</code> filter removes from its results all responses that did not return any type of error (RCODE=0)</p>
<p>The <code>exclude_noerror</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="40:2"><input checked="checked" id="__tabbed_40_1" name="__tabbed_40" type="radio" /><input id="__tabbed_40_2" name="__tabbed_40" type="radio" /><div class="tabbed-labels"><label for="__tabbed_40_1">YAML</label><label for="__tabbed_40_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">exclude_noerror</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;exclude_noerror&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><code>exclude_noerror</code> takes precedence over the "only_rcode" filter. If exclude_noerror = True, then the results will be composed only of responses WITH an error, that is, responses with RCODE=0 will not be returned.</p>
</div>
</div>
</div>
<p><br></p>
<div class="highlight"><pre><span></span><code>**only_dnssec_response:** *bool* &lt;a name=&quot;only_dnssec_response_v1&quot;&gt;&lt;/a&gt;&lt;br&gt;
&lt;font size=&quot;1&quot;&gt;[Back to DNS-v1 filters list](#dns_filters_v1)&lt;/font&gt;

Input: PCAP &lt;br&gt;

When you make a DNS query, the response you get may have a DNSSEC signature, which authenticates that DNS records originate from an authorized sender, thus protecting DNS from falsified information. &lt;br&gt;
To filter only responses signed by an authorized sender, use:
The `only_dnssec_response` filter usage syntax is:&lt;br&gt;

=== &quot;YAML&quot;
    ```yaml
    only_dnssec_response: true
    ```

=== &quot;JSON&quot;
    ```json
    {
    &quot;only_dnssec_response&quot;: true
    }
    ```
&lt;br&gt;
**answer_count:** *int* &lt;a name=&quot;answer_count_v1&quot;&gt;&lt;/a&gt;&lt;br&gt;
&lt;font size=&quot;1&quot;&gt;[Back to DNS-v1 filters list](#dns_filters_v1)&lt;/font&gt;

Input: PCAP &lt;br&gt;

One of the properties present in the query message structure is `Answer RRs`, which is the count of entries in the responses section (RR stands for “resource record”). &lt;br&gt;
The number of answers in the query is always zero, as a query message has only questions and no answers, and when the server sends the answer to that query, the value is set to the amount of entries in the answers section. &lt;br&gt;

The `answer_count` filter usage syntax is:&lt;br&gt;

=== &quot;YAML&quot;
    ```yaml
    answer_count: int
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;answer_count&quot;: int
    }
    ```

with the `int` referring to the desired amount of answer. &lt;br&gt;
Note that any value greater than zero that is defined will exclude queries from the results, since in queries the number of answers is always 0. &lt;br&gt;
As the answers count of queries is 0, whenever the value set for the answer_count is 0, both queries and responses will compose the result. &lt;br&gt;


A special case is the concept of `NODATA`, which is one of the possible returns to a query made to a DNS server is known as. This happens when the query is successful (so rcode:0), but there is no data as a response, so the number of answers is 0. &lt;br&gt;
In this case, to have in the results only the cases of `NODATA`, that is, the responses, the filter must be used together with the filter `exclude_noerror`.


Important information is that only one answer_count is possible for each handler. So, in order to have multiple counts on the same policy, multiple handlers must be created, each with an amount of answers.

**only_qtype:** *str[]* &lt;a name=&quot;only_qtype_v1&quot;&gt;&lt;/a&gt;&lt;br&gt;
&lt;font size=&quot;1&quot;&gt;[Back to DNS-v1 filters list](#dns_filters_v1)&lt;/font&gt;

Input: PCAP &lt;br&gt;

DNS record types are records that provide important information about a hostname or domain. Supported default types can be seen [here](https://github.com/orb-community/pktvisor/blob/develop/libs/visor_dns/dns.h#L30). &lt;br&gt;

The `only_qtype` filter usage syntax is:&lt;br&gt;

=== &quot;YAML&quot;
    ```yaml
    only_qtype: 
      - str
      - str
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;only_qtype&quot;: [
        &quot;str&quot;, &quot;str&quot;
      ]
    }
    ```
If you want to filter only IPV4 record types, for example, you should use: &lt;br&gt;

=== &quot;YAML&quot;
    ```yaml
    only_qtype:
      - &quot;A&quot;
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;only_qtype&quot;: [
        &quot;A&quot;
      ]
    }
    ```
or

=== &quot;YAML&quot;
    ```yaml
    only_qtype:
      - 1
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;only_qtype&quot;: [
        1
      ]
    }
    ```
Multiple types are also supported and both queries and responses that have any of the values in the array will be considered.

=== &quot;YAML&quot;
    ```yaml
    only_qtype:
      - 1
      - 2
      - &quot;A&quot;
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;only_qtype&quot;: [
        1,
        2,
        &quot;A&quot;
      ]
    }
    ```
&lt;br&gt;

**only_qname:** *str[]* &lt;a name=&quot;only_qname_v1&quot;&gt;&lt;/a&gt;&lt;br&gt;
&lt;font size=&quot;1&quot;&gt;[Back to DNS-v1 filters list](#dns_filters_v1)&lt;/font&gt;

Input: PCAP &lt;br&gt;


The `only_qname` filters dns packets based on queries and responses whose names exactly matches the strings present in the array. &lt;br&gt;
The `only_qname` filter usage syntax is:&lt;br&gt;

=== &quot;YAML&quot;
    ```yaml
    only_qname:
      - str
      - str
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;only_qname&quot;: [
        &quot;str&quot;, &quot;str&quot;
      ]
    }
    ```
Examples:

=== &quot;YAML&quot;
    ```yaml
    only_qname:
      - www.google.com
      - .nsone.net
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;only_qname&quot;: [
        &quot;www.google.com&quot;,
        &quot;.nsone.net&quot;
      ]
    }
    ```
&lt;br&gt;

**only_qname_suffix:** *str[]* &lt;a name=&quot;only_qname_suffix_v1&quot;&gt;&lt;/a&gt;&lt;br&gt;
&lt;font size=&quot;1&quot;&gt;[Back to DNS-v1 filters list](#dns_filters_v1)&lt;/font&gt;

Input: PCAP &lt;br&gt;


The `only_qname_suffix` filters queries and responses whose endings (suffixes) of the names match the strings present in the array. &lt;br&gt;
The `only_qname_suffix` filter usage syntax is:&lt;br&gt;

=== &quot;YAML&quot;
    ```yaml
    only_qname_suffix:
      - str
      - str
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;only_qname_suffix&quot;: [
        &quot;str&quot;, &quot;str&quot;
      ]
    }
    ```
Examples:

=== &quot;YAML&quot;
    ```yaml
    only_qname_suffix:
      - .google.com
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;only_qname_suffix&quot;: [
        &quot;.google.com&quot;
      ]
    }
    ```
or

=== &quot;YAML&quot;
    ```yaml
    only_qname_suffix:
      - google.com
      - .nsone.net
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;only_qname_suffix&quot;: [
        &quot;google.com&quot;,
        &quot;.nsone.net&quot;
      ]
    }
    ```
&lt;br&gt;
**geoloc_notfound:** *bool* &lt;a name=&quot;geoloc_notfound_v1&quot;&gt;&lt;/a&gt;&lt;br&gt;
&lt;font size=&quot;1&quot;&gt;[Back to DNS-v1 filters list](#dns_filters_v1)&lt;/font&gt;

Input: PCAP &lt;br&gt;


Based on ECS (EDNS Client Subnet) information, it is possible to determine the geolocation of where the query is being made. When the Subnet refers to a region found in the standard databases, the city, state and country (approximated) are returned. However, when based on the subnet it is not possible to determine the geolocation, a `not found` is returned. &lt;br&gt;
The `geoloc_notfound` filter only keeps responses whose geolocations were not found. &lt;br&gt;
The `geoloc_notfound` filter usage syntax is:&lt;br&gt;

=== &quot;YAML&quot;
    ```yaml
    geoloc_notfound: true
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;geoloc_notfound&quot;: true
    }
    ```
&lt;br&gt;
**asn_notfound:** *bool* &lt;a name=&quot;asn_notfound_v1&quot;&gt;&lt;/a&gt;&lt;br&gt;
&lt;font size=&quot;1&quot;&gt;[Back to DNS-v1 filters list](#dns_filters_v1)&lt;/font&gt;

Input: PCAP &lt;br&gt;


Based on ECS (EDNS Client Subnet) information, it is possible to determine the ASN (Autonomous System Number). When the IP of the subnet belongs to some not known ASN in the standard databases, a `not found` is returned. &lt;br&gt;
The `asn_notfound` filter only keeps responses whose asn were not found. &lt;br&gt;
The `asn_notfound` filter usage syntax is:&lt;br&gt;

=== &quot;YAML&quot;
    ```yaml
    asn_notfound: true
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;asn_notfound&quot;: true
    }
    ```
&lt;br&gt;


**only_queries:** *bool* &lt;a name=&quot;only_queries_v1&quot;&gt;&lt;/a&gt;&lt;br&gt;
&lt;font size=&quot;1&quot;&gt;[Back to DNS-v1 filters list](#dns_filters_v1)&lt;/font&gt;

Input: PCAP &lt;br&gt;


The `only_queries` filters out all dns response packets and its usage syntax is:&lt;br&gt;


=== &quot;YAML&quot;
    ```yaml
    only_queries: true
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;only_queries&quot;: true
    }
    ```
&lt;br&gt;



**only_responses:** *bool* &lt;a name=&quot;only_responses_v1&quot;&gt;&lt;/a&gt;&lt;br&gt;
&lt;font size=&quot;1&quot;&gt;[Back to DNS-v1 filters list](#dns_filters_v1)&lt;/font&gt;

Input: PCAP &lt;br&gt;


The `only_responses` filters out all dns queries packets and its usage syntax is: &lt;br&gt;

=== &quot;YAML&quot;
    ```yaml
    only_responses: true
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;only_responses&quot;: true
    }
    ```
&lt;br&gt;


**dnstap_msg_type:** *str* &lt;a name=&quot;dnstap_msg_type_v1&quot;&gt;&lt;/a&gt;&lt;br&gt;
&lt;font size=&quot;1&quot;&gt;[Back to DNS-v1 filters list](#dns_filters_v1)&lt;/font&gt;

Input: DNSTAP &lt;br&gt;

With a dnstap protocol it is possible to know the type of message that must be resolved in the request to the server. This filter therefore allows you to filter by response types.
Supported message types are: `auth`, `resolver`, `client`, `forwarder`, `stub`, `tool` and `update`.

The `dnstap_msg_type` filter usage syntax is:&lt;br&gt;

=== &quot;YAML&quot;
    ```yaml
    dnstap_msg_type: str
    ```
    Example:
    ```yaml
    dnstap_msg_type: auth
    ```
=== &quot;JSON&quot;
    ```json
    {
      &quot;dnstap_msg_type&quot;: &quot;str&quot;
    }
    ```
    Example:
    ```json
    {
      &quot;dnstap_msg_type&quot;: &quot;auth&quot;
    }
    ```
&lt;br&gt;
</code></pre></div>
<h4 id="configurations">Configurations <a name="dns_configurations"></a><br></h4>
<ul>
<li><a href="#public_suffix_list">public_suffix_list</a>: <em>bool</em>.</li>
<li><a href="#recorded_stream">recorded_stream</a>: <em>bool</em>. </li>
<li><a href="#xact_ttl">xact_ttl_secs</a>: <em>int</em>.</li>
<li><a href="#xact_ttl">xact_ttl_ms</a>: <em>int</em>.</li>
<li><a href="#abstract-configurations">Abstract configurations</a>. <br><br></li>
</ul>
<p><strong>public_suffix_list</strong> <a name="public_suffix_list"></a><br>
<font size="1"><a href="#dns_configurations">Back to DNS configurations list</a></font></p>
<p>Some names to be resolved by a dns server have public suffixes. These suffixes cause metrics to be generated considering non-relevant data. <br></p>
<p>The example below illustrates the benefit of using this type of configuration. The qnames consider each part of the name to be resolved. When a name has a public suffix, generic information is generated. Note that in the standard configuration, Qname2 and Qname3 are the same for both domains. With the public suffix setting <code>true</code> (which makes the entire public part be considered as a single part), Qname3 already displays relevant information about the name. <br>
The list of suffixes considered public can be accessed <a href="https://github.com/orb-community/pktvisor/blob/develop/libs/visor_dns/PublicSuffixList.h">here</a>. <br></p>
<table>
<thead>
<tr>
<th align="center">Name</th>
<th align="center">Qname2 Standard</th>
<th align="center">Qname3 Standard</th>
<th align="center">Qname2 Public Suffix</th>
<th align="center">Qname3 Public Suffix</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>www.imagine.qname.co.uk</code></td>
<td align="center">co.uk</td>
<td align="center">qname.co.uk</td>
<td align="center">qname.co.uk</td>
<td align="center">imagine.qname.co.uk</td>
</tr>
<tr>
<td align="center"><code>other.example.qname.co.uk</code></td>
<td align="center">co.uk</td>
<td align="center">qname.co.uk</td>
<td align="center">qname.co.uk</td>
<td align="center">example.qname.co.uk</td>
</tr>
</tbody>
</table>
<p>The <code>public_suffix_list</code> configuration usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="41:2"><input checked="checked" id="__tabbed_41_1" name="__tabbed_41" type="radio" /><input id="__tabbed_41_2" name="__tabbed_41" type="radio" /><div class="tabbed-labels"><label for="__tabbed_41_1">YAML</label><label for="__tabbed_41_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">public_suffix_list</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;public_suffix_list&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>recorded_stream</strong> <a name="recorded_stream"></a><br>
<font size="1"><a href="#dns_configurations">Back to DNS configurations list</a></font></p>
<p>This configuration is useful when a <a href="/documentation/orb_agent_configs/#pcap_file_input_pcap">pcap_file</a> is used in taps/input configuration. Set it to True when you want to load an offline traffic (from a pcap_file). <br></p>
<p>The <code>recorded_stream</code> configuration usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="42:2"><input checked="checked" id="__tabbed_42_1" name="__tabbed_42" type="radio" /><input id="__tabbed_42_2" name="__tabbed_42" type="radio" /><div class="tabbed-labels"><label for="__tabbed_42_1">YAML</label><label for="__tabbed_42_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">recorded_stream</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;recorded_stream&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>xact_ttl_ms</strong> OR <strong>xact_ttl_secs</strong> <a name="xact_ttl"></a><br>
<font size="1"><a href="#dns_configurations">Back to DNS configurations list</a></font></p>
<p>Both configurations have the same functionality, that is, defines the time to live of transactions, and only change the unit of measurement to be configured. This configuration causes the metrics to be generated for complete transactions (query and response) within the established time limit.<br></p>
<blockquote>
<ul>
<li>xact_ttl_ms: Defines the time to live of transactions in milliseconds.</li>
<li>xact_ttl_secs: Defines the time to live of transactions in seconds. <br></li>
</ul>
</blockquote>
<p>Note that <code>xact_ttl_ms</code> is dominant over <code>xact_ttl_secs</code>, that is, if <code>xact_ttl_ms</code> exists, even if <code>xact_ttl_secs</code> also exists, the value of <code>xact_ttl_ms</code> will be considered.</p>
<p>The <code>xact_ttl_ms</code> or <code>xact_ttl_secs</code> configuration usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="43:2"><input checked="checked" id="__tabbed_43_1" name="__tabbed_43" type="radio" /><input id="__tabbed_43_2" name="__tabbed_43" type="radio" /><div class="tabbed-labels"><label for="__tabbed_43_1">YAML</label><label for="__tabbed_43_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">xact_ttl_ms</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><span></span><code><span class="nt">xact_ttl_secs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;xact_ttl_ms&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5000</span>
<span class="p">}</span>
</code></pre></div>
<p>or</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;xact_ttl_secs&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="network-l2-l3-analyzer-net">Network (L2-L3) Analyzer (net)</h3>
<ul>
<li><a href="#NetPolicyExample">Example of policy</a></li>
<li><a href="#netv2_metrics_group">Metrics Group</a></li>
<li><a href="#net_filters_v2">Filters</a></li>
<li><a href="#net_configurations">Configurations</a></li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="44:2"><input checked="checked" id="__tabbed_44_1" name="__tabbed_44" type="radio" /><input id="__tabbed_44_2" name="__tabbed_44" type="radio" /><div class="tabbed-labels"><label for="__tabbed_44_1">NET(v2)</label><label for="__tabbed_44_2">NET(v1)</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Status: <code>Beta</code>. The metric names and configuration options may still change</p>
</div>
<h6 id="example-of-policy-with-input-pcap-and-handler-netv2">Example of policy with input pcap and handler NET(v2) <a name="NetPolicyExample"></a></h6>
<div class="tabbed-set tabbed-alternate" data-tabs="45:2"><input checked="checked" id="__tabbed_45_1" name="__tabbed_45" type="radio" /><input id="__tabbed_45_2" name="__tabbed_45" type="radio" /><div class="tabbed-labels"><label for="__tabbed_45_1">YAML</label><label for="__tabbed_45_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">handlers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">  </span><span class="nt">modules</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default_net</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">net</span>
<span class="w">      </span><span class="nt">require_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2.0&quot;</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">        </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">        </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
<span class="w">      </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">        </span><span class="nt">geoloc_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">asn_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">only_geoloc_prefix</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BR</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">US/CA</span>
<span class="w">        </span><span class="nt">only_asn_number</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7326</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16136</span>
<span class="w">      </span><span class="nt">metric_groups</span><span class="p">:</span>
<span class="w">        </span><span class="nt">disable</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cardinality</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">counters</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_geo</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_ips</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">quantiles</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span>
<span class="w">  </span><span class="nt">tap_selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">any</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value2</span>
<span class="w">  </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bpf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">net 192.168.1.0/24</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">iface</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wlo1</span>
<span class="w">    </span><span class="nt">host_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.1.0/24</span>
<span class="w">    </span><span class="nt">pcap_source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libpcap</span>
<span class="w">    </span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;default_net&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;net&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;require_version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.0&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;geoloc_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;asn_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;only_geoloc_prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;BR&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;US/CA&quot;</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;only_asn_number&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="mi">7326</span><span class="p">,</span>
<span class="w">            </span><span class="mi">16136</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;metric_groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;disable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;cardinality&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;counters&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_geo&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_ips&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;quantiles&quot;</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pcap&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tap_selector&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;any&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;key1&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value1&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;key2&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value2&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;bpf&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;net 192.168.1.0/24&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;iface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;wlo1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;host_spec&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.0/24&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;pcap_source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;libpcap&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;debug&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;collection&quot;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br></p>
<p><strong>Handler Type</strong>: "net" <br></p>
<h4 id="metrics-group-check-the-net-metrics-belonging-to-each-group">Metrics Group - <font size="1"><a href="/documentation/pktvisor_metrics/#network-metrics">Check the net metrics belonging to each group</a></font><br> <a name="netv2_metrics_group"></a></h4>
<table>
<thead>
<tr>
<th align="center">Metric Group</th>
<th align="center">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>cardinality</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>counters</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>top_geo</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>top_ips</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>quantiles</code></td>
<td align="center">enabled</td>
</tr>
</tbody>
</table>
<p><br></p>
<h4 id="filters_2">Filters <a name="net_filters_v2"></a><br></h4>
<table>
<thead>
<tr>
<th align="center">Filter</th>
<th align="center">Type</th>
<th align="center">Input</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a href="#geoloc_notfound_net_v2"><code>geoloc_notfound</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP, DNSTAP</td>
</tr>
<tr>
<td align="center"><a href="#asn_notfound_net_v2"><code>asn_notfound</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP, DNSTAP</td>
</tr>
<tr>
<td align="center"><a href="#only_geoloc_prefix_v2"><code>only_geoloc_prefix</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">PCAP, DNSTAP</td>
</tr>
<tr>
<td align="center"><a href="#only_asn_number_v2"><code>only_asn_number</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">PCAP, DNSTAP</td>
</tr>
</tbody>
</table>
<p><strong>geoloc_notfound:</strong> <em>bool</em> <a name="geoloc_notfound_net_v2"></a><br>
<font size="1"><a href="#net_filters_v2">Back to net-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>The source and destination IPs are used to determine the geolocation to know where the data is from and where it is going. When the IPs refer to a region found in the standard databases, the city, state and country (approximated) are returned. However, when it is not possible to determine the IP geolocation, a <code>not found</code> is returned. <br></p>
<p>The <code>geoloc_notfound</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="46:2"><input checked="checked" id="__tabbed_46_1" name="__tabbed_46" type="radio" /><input id="__tabbed_46_2" name="__tabbed_46" type="radio" /><div class="tabbed-labels"><label for="__tabbed_46_1">YAML</label><label for="__tabbed_46_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">geoloc_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;geoloc_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br>
<strong>asn_notfound:</strong> <em>bool</em> <a name="asn_notfound_net_v2"></a><br>
<font size="1"><a href="#net_filters_v2">Back to net-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>Based on source and destination IP, it is possible to determine the ASN (Autonomous System Number). When the IP of the source or destination belongs to some not known ASN in the standard databases, a <code>not found</code> is returned. <br></p>
<p>The <code>asn_notfound</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="47:2"><input checked="checked" id="__tabbed_47_1" name="__tabbed_47" type="radio" /><input id="__tabbed_47_2" name="__tabbed_47" type="radio" /><div class="tabbed-labels"><label for="__tabbed_47_1">YAML</label><label for="__tabbed_47_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">asn_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;asn_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br>
<strong>only_geoloc_prefix:</strong> <em>str[]</em> <a name="only_geoloc_prefix_v2"></a><br>
<font size="1"><a href="#net_filters_v2">Back to net-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>Source and destination IPs are used to determine the geolocation to know where the data is from and where it is going. In this way it is possible to filter the data considering the geolocation using the filter <code>only_geoloc_prefix</code>. <br></p>
<p>The <code>only_geoloc_prefix</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="48:2"><input checked="checked" id="__tabbed_48_1" name="__tabbed_48" type="radio" /><input id="__tabbed_48_2" name="__tabbed_48" type="radio" /><div class="tabbed-labels"><label for="__tabbed_48_1">YAML</label><label for="__tabbed_48_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="nt">only_geoloc_prefix</span><span class="p">:</span><span class="w"> </span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="nt">only_geoloc_prefix</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BR</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">US/CA</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_geoloc_prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;str&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_geoloc_prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;BR&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;US/CA&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></p>
</div>
</div>
</div>
<p><br>
<strong>only_asn_number:</strong> <em>str[]</em> <a name="only_asn_number_v2"></a><br>
<font size="1"><a href="#net_filters_v2">Back to net-v2 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>Based on source and destination IP, it is possible to determine the ASN (Autonomous System Number). In this way it is possible to filter the data considering a specific ASN using the filter <code>only_asn_number</code>. <br></p>
<p>The <code>only_asn_number</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="49:2"><input checked="checked" id="__tabbed_49_1" name="__tabbed_49" type="radio" /><input id="__tabbed_49_2" name="__tabbed_49" type="radio" /><div class="tabbed-labels"><label for="__tabbed_49_1">YAML</label><label for="__tabbed_49_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="nt">only_asn_number</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
</code></pre></div>
Example:  <br />
<div class="highlight"><pre><span></span><code><span class="nt">only_asn_number</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7326</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16136</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_asn_number&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;str&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_asn_number&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="mi">7326</span><span class="p">,</span>
<span class="w">    </span><span class="mi">16136</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></p>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<h6 id="example-of-policy-with-input-pcap-and-handler-netv1">Example of policy with input pcap and handler NET(v1)</h6>
<div class="tabbed-set tabbed-alternate" data-tabs="50:2"><input checked="checked" id="__tabbed_50_1" name="__tabbed_50" type="radio" /><input id="__tabbed_50_2" name="__tabbed_50" type="radio" /><div class="tabbed-labels"><label for="__tabbed_50_1">YAML</label><label for="__tabbed_50_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">handlers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">  </span><span class="nt">modules</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default_net</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">net</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">        </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">        </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
<span class="w">      </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">        </span><span class="nt">geoloc_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">asn_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">        </span><span class="nt">only_geoloc_prefix</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BR</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">US/CA</span>
<span class="w">        </span><span class="nt">only_asn_number</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7326</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16136</span>
<span class="w">      </span><span class="nt">metric_groups</span><span class="p">:</span>
<span class="w">        </span><span class="nt">disable</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cardinality</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">counters</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_geo</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_ips</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span>
<span class="w">  </span><span class="nt">tap_selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">any</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value2</span>
<span class="w">  </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bpf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">net 192.168.1.0/24</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">iface</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wlo1</span>
<span class="w">    </span><span class="nt">host_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.1.0/24</span>
<span class="w">    </span><span class="nt">pcap_source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libpcap</span>
<span class="w">    </span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;default_net&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;net&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;geoloc_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;asn_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;only_geoloc_prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;BR&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;US/CA&quot;</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;only_asn_number&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="mi">7326</span><span class="p">,</span>
<span class="w">            </span><span class="mi">16136</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;metric_groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;disable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;cardinality&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;counters&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_geo&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_ips&quot;</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pcap&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tap_selector&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;any&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;key1&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value1&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;key2&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value2&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;bpf&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;net 192.168.1.0/24&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;iface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;wlo1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;host_spec&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.0/24&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;pcap_source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;libpcap&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;debug&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;collection&quot;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br></p>
<p><strong>Handler Type</strong>: "net" <br></p>
<h4 id="metrics-group-check-the-net-metrics-belonging-to-each-group_1">Metrics Group  - <font size="1"><a href="/documentation/pktvisor_metrics/#network-metrics">Check the net metrics belonging to each group</a></font><br> <a name="netv1_metrics_group"></a></h4>
<table>
<thead>
<tr>
<th align="center">Metric Group</th>
<th align="center">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>cardinality</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>counters</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>top_geo</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>top_ips</code></td>
<td align="center">enabled</td>
</tr>
</tbody>
</table>
<p><br></p>
<h4 id="filters_3">Filters <a name="net_filters_v1"></a><br></h4>
<table>
<thead>
<tr>
<th align="center">Filter</th>
<th align="center">Type</th>
<th align="center">Input</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a href="#geoloc_notfound_net_v1"><code>geoloc_notfound</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP, DNSTAP</td>
</tr>
<tr>
<td align="center"><a href="#asn_notfound_net_v1"><code>asn_notfound</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">PCAP, DNSTAP</td>
</tr>
<tr>
<td align="center"><a href="#only_geoloc_prefix_v1"><code>only_geoloc_prefix</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">PCAP, DNSTAP</td>
</tr>
<tr>
<td align="center"><a href="#only_asn_number_v1"><code>only_asn_number</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">PCAP, DNSTAP</td>
</tr>
</tbody>
</table>
<p><strong>geoloc_notfound:</strong> <em>bool</em> <a name="geoloc_notfound_net_v1"></a><br>
<font size="1"><a href="#net_filters_v1">Back to net-v1 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>The source and destination IPs are used to determine the geolocation to know where the data is from and where it is going. When the IPs refer to a region found in the standard databases, the city, state and country (approximated) are returned. However, when it is not possible to determine the IP geolocation, a <code>not found</code> is returned. <br></p>
<p>The <code>geoloc_notfound</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="51:2"><input checked="checked" id="__tabbed_51_1" name="__tabbed_51" type="radio" /><input id="__tabbed_51_2" name="__tabbed_51" type="radio" /><div class="tabbed-labels"><label for="__tabbed_51_1">YAML</label><label for="__tabbed_51_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">geoloc_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;geoloc_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br>
<strong>asn_notfound:</strong> <em>bool</em> <a name="asn_notfound_net_v1"></a><br>
<font size="1"><a href="#net_filters_v1">Back to net-v1 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>Based on source and destination IP, it is possible to determine the ASN (Autonomous System Number). When the IP of the source or destination belongs to some not known ASN in the standard databases, a <code>not found</code> is returned. <br></p>
<p>The <code>asn_notfound</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="52:2"><input checked="checked" id="__tabbed_52_1" name="__tabbed_52" type="radio" /><input id="__tabbed_52_2" name="__tabbed_52" type="radio" /><div class="tabbed-labels"><label for="__tabbed_52_1">YAML</label><label for="__tabbed_52_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">asn_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;asn_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br>
<strong>only_geoloc_prefix:</strong> <em>str[]</em> <a name="only_geoloc_prefix_v1"></a><br>
<font size="1"><a href="#net_filters_v1">Back to net-v1 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>Source and destination IPs are used to determine the geolocation to know where the data is from and where it is going. In this way it is possible to filter the data using the geolocation using the filter <code>only_geoloc_prefix</code>. <br>.  The filter supports the following strings:</p>
</div>
</div>
</div>
<ul>
<li>
<p>Continents:  two-character continent code, as follows:
AF - Africa
AN - Antarctica
AS - Asia
EU - Europe
NA - North America
OC - Oceania
SA - South America</p>
</li>
<li>
<p>Country: the two-character ISO 3166-1 country code</p>
</li>
<li>
<p>Subdivision: the region-portion of the ISO 3166-2 code for the region</p>
<p>The <code>only_geoloc_prefix</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="53:2"><input checked="checked" id="__tabbed_53_1" name="__tabbed_53" type="radio" /><input id="__tabbed_53_2" name="__tabbed_53" type="radio" /><div class="tabbed-labels"><label for="__tabbed_53_1">YAML</label><label for="__tabbed_53_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="nt">only_geoloc_prefix</span><span class="p">:</span><span class="w"> </span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="nt">only_geoloc_prefix</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BR</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">US/CA</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_geoloc_prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;str&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_geoloc_prefix&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;BR&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;US/CA&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></p>
</div>
</div>
</div>
<p><br>
<strong>only_asn_number:</strong> <em>str[]</em> <a name="only_asn_number_v1"></a><br>
<font size="1"><a href="#net_filters_v1">Back to net-v1 filters list</a></font></p>
<p>Input: PCAP <br></p>
<p>Based on source and destination IP, it is possible to determine the ASN (Autonomous System Number). In this way it is possible to filter the data considering a specific ASN using the filter <code>only_asn_number</code>. <br></p>
<p>The <code>only_asn_number</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="54:2"><input checked="checked" id="__tabbed_54_1" name="__tabbed_54" type="radio" /><input id="__tabbed_54_2" name="__tabbed_54" type="radio" /><div class="tabbed-labels"><label for="__tabbed_54_1">YAML</label><label for="__tabbed_54_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="nt">only_asn_number</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">str</span>
</code></pre></div>
Example:  <br />
<div class="highlight"><pre><span></span><code><span class="nt">only_asn_number</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7326</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16136</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_asn_number&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;str&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;str&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_asn_number&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="mi">7326</span><span class="p">,</span>
<span class="w">    </span><span class="mi">16136</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></p>
</div>
</div>
</div>
</li>
</ul>
<h4 id="configurations_1">Configurations <a name="net_configurations"></a><br></h4>
<ul>
<li><a href="#recorded_stream_net">recorded_stream</a>: <em>bool</em>.</li>
<li><a href="#abstract-configurations">Abstract configurations</a>. <br><br></li>
</ul>
<p><strong>recorded_stream</strong> <a name="recorded_stream_net"></a><br>
<font size="1"><a href="#net_configurations">Back to net configurations list</a></font></p>
<p>This configuration is useful when a <a href="/documentation/orb_agent_configs/#pcap_file_input_pcap">pcap_file</a> is used in taps/input configuration. Set it to True when you want to load an offline traffic (from a pcap_file). <br></p>
<p>The <code>recorded_stream</code> configuration usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="55:2"><input checked="checked" id="__tabbed_55_1" name="__tabbed_55" type="radio" /><input id="__tabbed_55_2" name="__tabbed_55" type="radio" /><div class="tabbed-labels"><label for="__tabbed_55_1">YAML</label><label for="__tabbed_55_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">recorded_stream</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;recorded_stream&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="dhcp-analyzer-dhcp">DHCP Analyzer (dhcp)</h3>
<ul>
<li><a href="#DhcpPolicyExample">Example of policy</a></li>
<li><a href="#dhcp_metrics_group">Metrics Group</a></li>
<li><a href="#dhcp_filters">Filters</a></li>
<li><a href="#dhcp_configurations">Configurations</a></li>
</ul>
<h6 id="example-of-policy-with-input-pcap-and-handler-dhcp">Example of policy with input pcap and handler DHCP <a name="DhcpPolicyExample"></a></h6>
<div class="tabbed-set tabbed-alternate" data-tabs="56:2"><input checked="checked" id="__tabbed_56_1" name="__tabbed_56" type="radio" /><input id="__tabbed_56_2" name="__tabbed_56" type="radio" /><div class="tabbed-labels"><label for="__tabbed_56_1">YAML</label><label for="__tabbed_56_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">handlers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">  </span><span class="nt">modules</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default_dhcp</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dhcp</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">        </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">        </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span>
<span class="w">  </span><span class="nt">tap_selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">all</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">  </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bpf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">net 192.168.1.0/24</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">iface</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wlo1</span>
<span class="w">    </span><span class="nt">host_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.1.0/24</span>
<span class="w">    </span><span class="nt">pcap_source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libpcap</span>
<span class="w">    </span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;default_dhcp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dhcp&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pcap&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tap_selector&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;key1&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value1&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;key2&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;bpf&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;net 192.168.1.0/24&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;iface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;wlo1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;host_spec&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.0/24&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;pcap_source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;libpcap&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;debug&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;collection&quot;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br></p>
<p><strong>Handler Type</strong>: "dhcp" <br></p>
<h4 id="metrics-group-check-dhcp-metrics">Metrics Group - <font size="1"><a href="/documentation/pktvisor_metrics/#dhcp-metrics">Check dhcp metrics</a></font><br> <a name="dhcp_metrics_group"></a></h4>
<ul>
<li>No metrics group available <br></li>
</ul>
<h4 id="filters_4">Filters <a name="dhcp_filters"></a><br></h4>
<ul>
<li>No filters available. <br><br></li>
</ul>
<h4 id="configurations_2">Configurations <a name="dhcp_configurations"></a><br></h4>
<ul>
<li><a href="#abstract-configurations">Abstract configurations</a>. <br><br></li>
</ul>
<h3 id="bgp-analyzer-bgp">BGP Analyzer (bgp)</h3>
<ul>
<li><a href="#BgpPolicyExample">Example of policy</a></li>
<li><a href="#bgp_metrics_group">Metrics Group</a></li>
<li><a href="#bgp_filters">Filters</a></li>
<li><a href="#bgp_configurations">Configurations</a></li>
</ul>
<h6 id="example-of-policy-with-input-pcap-and-handler-bgp">Example of policy with input pcap and handler BGP <a name="BgpPolicyExample"></a></h6>
<div class="tabbed-set tabbed-alternate" data-tabs="57:2"><input checked="checked" id="__tabbed_57_1" name="__tabbed_57" type="radio" /><input id="__tabbed_57_2" name="__tabbed_57" type="radio" /><div class="tabbed-labels"><label for="__tabbed_57_1">YAML</label><label for="__tabbed_57_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">handlers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">  </span><span class="nt">modules</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default_bgp</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bgp</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">        </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">        </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span>
<span class="w">  </span><span class="nt">tap_selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">all</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">key2</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">value</span>
<span class="w">  </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bpf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">net 192.168.1.0/24</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">iface</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wlo1</span>
<span class="w">    </span><span class="nt">host_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.1.0/24</span>
<span class="w">    </span><span class="nt">pcap_source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libpcap</span>
<span class="w">    </span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">config</span><span class="p">:</span>
<span class="w">  </span><span class="nt">merge_like_handlers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">        </span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;default_bgp&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bgp&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pcap&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tap_selector&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;key1&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value1&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;key2&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;bpf&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;net 192.168.1.0/24&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;iface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;wlo1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;host_spec&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.0/24&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;pcap_source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;libpcap&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;debug&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;merge_like_handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;collection&quot;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br></p>
<p><strong>Handler Type</strong>: "bgp" <br></p>
<h4 id="metrics-group-check-bgp-metrics">Metrics Group - <font size="1"><a href="/documentation/pktvisor_metrics/#bgp-metrics">Check BGP metrics</a></font><br> <a name="bgp_metrics_group"></a></h4>
<ul>
<li>No metrics group available <br></li>
</ul>
<h4 id="filters_5">Filters <a name="bgp_filters"></a><br></h4>
<ul>
<li>No filters available. <br><br></li>
</ul>
<h4 id="configurations_3">Configurations <a name="bgp_configurations"></a><br></h4>
<ul>
<li><a href="#abstract-configurations">Abstract configurations</a>. <br><br></li>
</ul>
<h3 id="packet-capture-analyzer-pcap">Packet Capture Analyzer (pcap)</h3>
<ul>
<li><a href="#PcapPolicyExample">Example of policy</a></li>
<li><a href="#pcap_metrics_group">Metrics Group</a></li>
<li><a href="#pcap_filters">Filters</a></li>
<li><a href="#pcap_configurations">Configurations</a></li>
</ul>
<h6 id="example-of-policy-with-input-pcap-and-handler-pcap">Example of policy with input pcap and handler PCAP <a name="PcapPolicyExample"></a></h6>
<div class="tabbed-set tabbed-alternate" data-tabs="58:2"><input checked="checked" id="__tabbed_58_1" name="__tabbed_58" type="radio" /><input id="__tabbed_58_2" name="__tabbed_58" type="radio" /><div class="tabbed-labels"><label for="__tabbed_58_1">YAML</label><label for="__tabbed_58_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">handlers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">    </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">  </span><span class="nt">modules</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default_pcap</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<span class="w">        </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="w">        </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">25</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pcap</span>
<span class="w">  </span><span class="nt">tap</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default_pcap</span>
<span class="w">  </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bpf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">net 192.168.1.0/24</span>
<span class="w">  </span><span class="nt">config</span><span class="p">:</span>
<span class="w">    </span><span class="nt">iface</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wlo1</span>
<span class="w">    </span><span class="nt">host_spec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.1.0/24</span>
<span class="w">    </span><span class="nt">pcap_source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libpcap</span>
<span class="w">    </span><span class="nt">debug</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;default_pcap&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pcap&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;pcap&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tap&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default_pcap&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;bpf&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;net 192.168.1.0/24&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;iface&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;wlo1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;host_spec&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;192.168.1.0/24&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;pcap_source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;libpcap&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;debug&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;collection&quot;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br></p>
<p><strong>Handler Type</strong>: "pcap" <br></p>
<h4 id="metrics-group-check-pcap-metrics">Metrics Group - <font size="1"><a href="/documentation/pktvisor_metrics/#pcap-metrics">Check pcap metrics</a></font><br> <a name="pcap_metrics_group"></a></h4>
<ul>
<li>No metrics group available. <br></li>
</ul>
<h4 id="filters_6">Filters <a name="pcap_filters"></a><br></h4>
<ul>
<li>No filters available. <br></li>
</ul>
<h4 id="configurations_4">Configurations <a name="pcap_configurations"></a><br></h4>
<ul>
<li><a href="#abstract-configurations">Abstract configurations</a>. <br></li>
</ul>
<h3 id="flow-analyzer-flow-beta">Flow Analyzer (flow) [BETA]</h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Status: <code>Beta</code>. The metric names and configuration options may still change</p>
</div>
<ul>
<li><a href="#FlowPolicyExample">Example of policy</a></li>
<li><a href="#flow_metrics_group">Metrics Group</a></li>
<li><a href="#flow_filters">Filters</a></li>
<li><a href="#flow_configurations">Configurations</a></li>
</ul>
<h6 id="example-of-policy-with-input-flow-and-handler-flow">Example of policy with input flow and handler FLOW <a name="FlowPolicyExample"></a></h6>
<div class="tabbed-set tabbed-alternate" data-tabs="59:2"><input checked="checked" id="__tabbed_59_1" name="__tabbed_59" type="radio" /><input id="__tabbed_59_2" name="__tabbed_59" type="radio" /><div class="tabbed-labels"><label for="__tabbed_59_1">YAML</label><label for="__tabbed_59_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">handlers</span><span class="p">:</span>
<span class="w">    </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">95</span>
<span class="w">        </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span>
<span class="w">        </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">modules</span><span class="p">:</span>
<span class="w">        </span><span class="nt">my_flow</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flow</span>
<span class="w">            </span><span class="nt">config</span><span class="p">:</span>
<span class="w">                </span><span class="nt">sample_rate_scaling</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">                </span><span class="nt">deep_sample_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">85</span>
<span class="w">                </span><span class="nt">num_periods</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">                </span><span class="nt">topn_count</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
<span class="w">                </span><span class="nt">first_filter_if_as_label</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">                </span><span class="nt">enrichment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">                </span><span class="nt">device_map</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">192.168.3.32</span><span class="p">:</span>
<span class="w">                    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Device1</span>
<span class="w">                    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">This is a device map example</span>
<span class="w">                    </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">                      </span><span class="nt">2</span><span class="p">:</span>
<span class="w">                        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prov1</span>
<span class="w">                        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">This is an interface map example</span>
<span class="w">                </span><span class="nt">summarize_ips_by_asn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">                </span><span class="nt">exclude_unknown_asns_from_summarization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">                </span><span class="nt">exclude_asns_from_summarization</span><span class="p">:</span>
<span class="w">                  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16509</span>
<span class="w">                </span><span class="nt">exclude_ips_from_summarization_flow</span><span class="p">:</span>
<span class="w">                  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.3.32/32</span>
<span class="w">            </span><span class="nt">metric_groups</span><span class="p">:</span>
<span class="w">                </span><span class="nt">enable</span><span class="p">:</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cardinality</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">counters</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_geo</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">by_packets</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">by_bytes</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conversations</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_ports</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_ips</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_interfaces</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_ips_ports</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top_tos</span>
<span class="w">            </span><span class="nt">filter</span><span class="p">:</span>
<span class="w">                </span><span class="nt">only_ports</span><span class="p">:</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10853</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10860-10890</span>
<span class="w">                </span><span class="nt">only_device_interfaces</span><span class="p">:</span>
<span class="w">                    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">216.239.38.10</span><span class="p">:</span>
<span class="w">                        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">                </span><span class="nt">only_directions</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;in&quot;</span>
<span class="w">                </span><span class="nt">only_ips</span><span class="p">:</span>
<span class="w">                  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.2.1/24</span>
<span class="w">                  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.158.1.38/32</span>
<span class="w">                </span><span class="nt">geoloc_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">                </span><span class="nt">asn_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">flow</span>
<span class="w">  </span><span class="nt">tap</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default_flow</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">95</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;my_flow&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;flow&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;sample_rate_scaling&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;deep_sample_rate&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">85</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;num_periods&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;topn_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;first_filter_if_as_label&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;enrichment&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;device_map&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;192.168.3.32&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Device1&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;This is a device map example&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;interfaces&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;2&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Prov1&quot;</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;This is an interface map example&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">              </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">},</span>
<span class="w">          </span><span class="nt">&quot;summarize_ips_by_asn&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;exclude_unknown_asns_from_summarization&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;exclude_asns_from_summarization&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="mi">16509</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;exclude_ips_from_summarization_flow&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;192.168.3.32/32&quot;</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;metric_groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;cardinality&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;counters&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_geo&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;by_packets&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;by_bytes&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;conversations&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_ports&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_ips&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_interfaces&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_ips_ports&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;top_tos&quot;</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;only_ports&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="mi">10853</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;10860-10890&quot;</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;only_device_interfaces&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;216.239.38.10&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="mi">2</span>
<span class="w">              </span><span class="p">]</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;only_directions&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;in&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;only_ips&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;192.168.2.1/24&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;192.158.1.38/32&quot;</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;geoloc_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;asn_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;flow&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tap&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default_flow&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;collection&quot;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br></p>
<p><strong>Handler Type</strong>: "flow" <br></p>
<h4 id="metrics-group-check-the-flow-metrics-belonging-to-each-group">Metrics Group - <font size="1"><a href="/documentation/pktvisor_metrics/#flow-metrics-beta">Check the flow metrics belonging to each group</a></font><br> <a name="flow_metrics_group"></a></h4>
<table>
<thead>
<tr>
<th align="center">Metric Group</th>
<th align="center">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>cardinality</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>counters</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>by_packets</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>by_bytes</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>top_ips</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>top_ports</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>top_ips_ports</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>top_geo</code></td>
<td align="center">disabled</td>
</tr>
<tr>
<td align="center"><code>conversations</code></td>
<td align="center">disabled</td>
</tr>
<tr>
<td align="center"><code>top_interfaces</code></td>
<td align="center">disabled</td>
</tr>
<tr>
<td align="center"><code>top_tos</code></td>
<td align="center">disabled</td>
</tr>
</tbody>
</table>
<h4 id="filters_7">Filters <a name="flow_filters"></a><br></h4>
<table>
<thead>
<tr>
<th align="center">Filter</th>
<th align="center">Type</th>
<th align="center">Input</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a href="#only_device_interfaces"><code>only_device_interfaces</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">FLOW</td>
</tr>
<tr>
<td align="center"><a href="#only_directions"><code>only_directions</code></a></td>
<td align="center"><em>str</em></td>
<td align="center">FLOW</td>
</tr>
<tr>
<td align="center"><a href="#only_ips_flow"><code>only_ips</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">FLOW</td>
</tr>
<tr>
<td align="center"><a href="#only_ports_flow"><code>only_ports</code></a></td>
<td align="center"><em>str[]</em></td>
<td align="center">FLOW</td>
</tr>
<tr>
<td align="center"><a href="#geoloc_notfound_flow"><code>geoloc_notfound</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">FLOW</td>
</tr>
<tr>
<td align="center"><a href="#asn_notfound_flow"><code>asn_notfound</code></a></td>
<td align="center"><em>bool</em></td>
<td align="center">FLOW</td>
</tr>
</tbody>
</table>
<p><strong>only_device_interfaces:</strong> <em>str[]</em> <a name="only_device_interfaces"></a><br>
<font size="1"><a href="#flow_filters">Back to flow filters list</a></font></p>
<p>Input: FLOW <br></p>
<p><code>only_device_interfaces</code> filters data by only retaining flows coming from the specific devices and interfaces defined in this filter. <br>
The difference between <code>only_device_interfaces</code> and <code>only_ips</code> is that <code>only_ips</code> filters based on the IPs observed <em>inside</em> the flows, while <code>only_device_interfaces</code> filters based on the device and interface <em>sending</em> the flows. <br></p>
<p>The <code>only_device_interfaces</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="60:2"><input checked="checked" id="__tabbed_60_1" name="__tabbed_60" type="radio" /><input id="__tabbed_60_2" name="__tabbed_60" type="radio" /><div class="tabbed-labels"><label for="__tabbed_60_1">YAML</label><label for="__tabbed_60_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="nt">only_device_interfaces</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">device</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">interface</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="nt">only_device_interfaces</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">216.239.38.10</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w"> </span><span class="c1">#port can be passed as int</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4-10</span><span class="w"> </span><span class="c1">#port can be passed as range. Ports from 4 to 10: all ports in this interval will be accepted.</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="c1">#port can be passed as str</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">192.158.1.38</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">9</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4-10</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">192.168.2.32</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;*&quot;</span><span class="w"> </span><span class="c1">#all ports</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_device_interfaces&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;device&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;interface&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_device_interfaces&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;216.239.38.10&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mi">2</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;4-10&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;10853&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;192.158.1.38&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mi">3</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;10860-10890&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;192.168.2.32&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;*&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></p>
</div>
</div>
</div>
<p><br>
<strong>only_directions:</strong> <em>str[]</em> <a name="only_directions"></a><br>
<font size="1"><a href="#flow_filters">Back to flow filters list</a></font></p>
<p><code>only_directions</code> filters data by its direction. Options are: "in" and/or "out". </p>
<p>The <code>only_directions</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="61:2"><input checked="checked" id="__tabbed_61_1" name="__tabbed_61" type="radio" /><input id="__tabbed_61_2" name="__tabbed_61" type="radio" /><div class="tabbed-labels"><label for="__tabbed_61_1">YAML</label><label for="__tabbed_61_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="nt">only_directions</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">str</span><span class="p p-Indicator">]</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="nt">only_directions</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;in&quot;</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_directions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;str&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_directions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;in&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></p>
</div>
</div>
</div>
<p><br></p>
<p><strong>only_ips:</strong> <em>str[]</em> <a name="only_ips_flow"></a><br>
<font size="1"><a href="#flow_filters">Back to flow filters list</a></font></p>
<p>Input: FLOW <br></p>
<p>To filter data only from certain source OR destination, you can use <code>only_ips</code> filter, for which CIDR (Inter-Domain Routing Classes) ranges are supported. <br></p>
<p>The <code>only_ips</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="62:2"><input checked="checked" id="__tabbed_62_1" name="__tabbed_62" type="radio" /><input id="__tabbed_62_2" name="__tabbed_62" type="radio" /><div class="tabbed-labels"><label for="__tabbed_62_1">YAML</label><label for="__tabbed_62_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="nt">only_ips</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">array</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="nt">only_ips</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.1.1/24</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.158.1.38/32</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_ips&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;array&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_ips&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;192.168.2.1/24&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;192.158.1.38/32&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></p>
</div>
</div>
</div>
<p><br>
<strong>only_ports:</strong> <em>str[]</em> <a name="only_ports_flow"></a><br>
<font size="1"><a href="#flow_filters">Back to flow filters list</a></font></p>
<p>Input: FLOW <br></p>
<p><code>only_ports</code> filter only filters data being sent to or received on one of the selected TCP/UDP ports (or range of ports). <br></p>
<p>The <code>only_ports</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="63:2"><input checked="checked" id="__tabbed_63_1" name="__tabbed_63" type="radio" /><input id="__tabbed_63_2" name="__tabbed_63" type="radio" /><div class="tabbed-labels"><label for="__tabbed_63_1">YAML</label><label for="__tabbed_63_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="nt">only_ports</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">array</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="nt">only_ports</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10853</span><span class="w"> </span><span class="c1">#port can be passed as int</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;10854&quot;</span><span class="w"> </span><span class="c1">#port can be passed as str</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10860-10890</span><span class="w"> </span><span class="c1">#range from 10860 to 10890. All ports in this interval will be accepted</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_ports&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;array&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;only_ports&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="mi">10853</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;10854&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;10860-10890&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></p>
</div>
</div>
</div>
<p><br>
<strong>geoloc_notfound:</strong> <em>bool</em> <a name="geoloc_notfound_flow"></a><br>
<font size="1"><a href="#flow_filters">Back to flow filters list</a></font></p>
<p>Input: FLOW <br></p>
<p>The source and destination IPs are used to determine the geolocation to know where the data is from and where it is going. When the IPs refer to a region found in the standard databases, the city, state and country (approximated) are returned. However, when it is not possible to determine the IP geolocation, a <code>not found</code> is returned. <br></p>
<p>The <code>geoloc_notfound</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="64:2"><input checked="checked" id="__tabbed_64_1" name="__tabbed_64" type="radio" /><input id="__tabbed_64_2" name="__tabbed_64" type="radio" /><div class="tabbed-labels"><label for="__tabbed_64_1">YAML</label><label for="__tabbed_64_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">geoloc_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;geoloc_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br>
<strong>asn_notfound:</strong> <em>bool</em> <a name="asn_notfound_flow"></a><br>
<font size="1"><a href="#flow_filters">Back to flow filters list</a></font></p>
<p>Input: FLOW <br></p>
<p>Based on source and destination IP, it is possible to determine the ASN (Autonomous System Number). When the IP of the source or destination belongs to some not known ASN in the standard databases, a <code>not found</code> is returned. <br></p>
<p>The <code>asn_notfound</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="65:2"><input checked="checked" id="__tabbed_65_1" name="__tabbed_65" type="radio" /><input id="__tabbed_65_2" name="__tabbed_65" type="radio" /><div class="tabbed-labels"><label for="__tabbed_65_1">YAML</label><label for="__tabbed_65_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">asn_notfound</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;asn_notfound&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br></p>
<h4 id="configurations_5">Configurations <a name="flow_configurations"></a><br></h4>
<ul>
<li><a href="#sample_rate_scaling_flow">sample_rate_scaling</a>: <em>bool</em> <br></li>
<li><a href="#first_filter_if_as_label_flow">first_filter_if_as_label</a>: <em>bool</em> <br></li>
<li><a href="#enrichment_flow">enrichment</a>: <em>bool</em> <br></li>
<li><a href="#device_map_flow">device_map</a>: <em>map</em> <br></li>
<li><a href="#summarize_ips_by_asn_flow">summarize_ips_by_asn</a>: <em>bool</em> <br></li>
<li><a href="#exclude_asns_from_summarization_flow">exclude_asns_from_summarization</a>: <em>str[]</em> <br></li>
<li><a href="#exclude_unknown_asns_from_summarization_flow">exclude_unknown_asns_from_summarization</a>: <em>bool</em> <br></li>
<li><a href="#subnets_for_summarization_flow">subnets_for_summarization</a>: <em>str[]</em> <br></li>
<li><a href="#exclude_ips_from_summarization_flow">exclude_ips_from_summarization</a> <em>str[]</em> <br></li>
<li><a href="#recorded_stream_flow">recorded_stream</a>: <em>bool</em><br></li>
<li><a href="#abstract-configurations">Abstract configurations</a>. <br><br></li>
</ul>
<p><strong>sample_rate_scaling</strong> <a name="sample_rate_scaling_flow"></a><br>
<font size="1"><a href="#flow_configurations">Back to flow configurations list</a></font></p>
<p>By default, flow metrics are generated by an approximation based on sampling the data. 1 packet every N is analyzed and the prediction of the entire population is made from the sample. If you want to see exactly all the exact data, you can disable <code>sample_rate_scaling</code>. <br></p>
<p>The <code>sample_rate_scaling</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="66:2"><input checked="checked" id="__tabbed_66_1" name="__tabbed_66" type="radio" /><input id="__tabbed_66_2" name="__tabbed_66" type="radio" /><div class="tabbed-labels"><label for="__tabbed_66_1">YAML</label><label for="__tabbed_66_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">sample_rate_scaling</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;sample_rate_scaling&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>first_filter_if_as_label</strong> <a name="first_filter_if_as_label_flow"></a><br>
<font size="1"><a href="#flow_configurations">Back to flow configurations list</a></font></p>
<p>This configuration requires the <code>only_interfaces</code> filter to be active (true). If this setting is <code>true</code>, the interfaces will be used as labels for the metrics.</p>
<p>The <code>first_filter_if_as_label</code> filter usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="67:2"><input checked="checked" id="__tabbed_67_1" name="__tabbed_67" type="radio" /><input id="__tabbed_67_2" name="__tabbed_67" type="radio" /><div class="tabbed-labels"><label for="__tabbed_67_1">YAML</label><label for="__tabbed_67_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">first_filter_if_as_label</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;first_filter_if_as_label&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>enrichment</strong> <a name="enrichment_flow"></a><br>
<font size="1"><a href="#flow_configurations">Back to flow configurations list</a></font></p>
<p>When true, uses device map settings.</p>
<p>The <code>enrichment</code> configuration usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="68:2"><input checked="checked" id="__tabbed_68_1" name="__tabbed_68" type="radio" /><input id="__tabbed_68_2" name="__tabbed_68" type="radio" /><div class="tabbed-labels"><label for="__tabbed_68_1">YAML</label><label for="__tabbed_68_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">enrichment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="nt">&quot;enrichment&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>device_map</strong> <a name="device_map_flow"></a><br>
<font size="1"><a href="#flow_configurations">Back to flow configurations list</a></font></p>
<p>This configuration allows the user to assign a custom name to devices and interfaces, and the proper functioning of this configuration depends on the <a href="#enrichment_flow">enrichment</a> being True.</p>
<p>The <code>device_map</code> configuration usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="69:2"><input checked="checked" id="__tabbed_69_1" name="__tabbed_69" type="radio" /><input id="__tabbed_69_2" name="__tabbed_69" type="radio" /><div class="tabbed-labels"><label for="__tabbed_69_1">YAML</label><label for="__tabbed_69_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="nt">device_map</span><span class="p">:</span>
<span class="w">  </span><span class="nt">device_ip</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="w"> </span><span class="c1">#name is required</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Optionally</span><span class="nv"> </span><span class="s">set</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">description&quot;</span>
<span class="w">    </span><span class="nt">interfaces</span><span class="p">:</span><span class="w"> </span><span class="c1">#Interfaces are optional</span>
<span class="w">        </span><span class="nt">interface</span><span class="p">:</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;str&quot;</span><span class="w"> </span><span class="c1">#required</span>
<span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Optionally</span><span class="nv"> </span><span class="s">set</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">description&quot;</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="nt">device_map</span><span class="p">:</span>
<span class="w">  </span><span class="nt">192.168.2.32</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Cisco</span>
<span class="w">    </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">This is a device map example</span>
<span class="w">    </span><span class="nt">interfaces</span><span class="p">:</span>
<span class="w">      </span><span class="nt">2</span><span class="p">:</span>
<span class="w">        </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">GoogleProv</span>
<span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">This is an interface map example</span>
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;device_map&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;device_ip&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;str&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Optionally set a description&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;interfaces&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;interface&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;str&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Optionally set a description&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;device_map&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;192.168.2.32&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Cisco&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;This is a device map example&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;interfaces&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;2&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;GoogleProv&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;This is an interface map example&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
</div>
</div>
</div>
<p>Summarization is a useful strategy for visualization, but also for decreasing the cardinality of the data, and two types of summarization are supported: by <a href="#summarize_ips_by_asn_flow">asn</a> and by <a href="#subnets_for_summarization_flow">subnets</a>, and summarization by ASN is dominant over subnet, i.e. If both configurations are present, only the IPs of an excluded asn or an unknown asn (if <a href="#exclude_unknown_asns_from_summarization_flow">exclude_unknown_asns_from_summarization</a> is true) will be summarized by subnet.</p>
<p><strong>summarize_ips_by_asn</strong> <a name="summarize_ips_by_asn_flow"></a><br>
<font size="1"><a href="#flow_configurations">Back to flow configurations list</a></font></p>
<p>When True, it summarizes data by ASN (Autonomous System Number).</p>
<p>The <code>summarize_ips_by_asn</code> configuration usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="70:2"><input checked="checked" id="__tabbed_70_1" name="__tabbed_70" type="radio" /><input id="__tabbed_70_2" name="__tabbed_70" type="radio" /><div class="tabbed-labels"><label for="__tabbed_70_1">YAML</label><label for="__tabbed_70_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">summarize_ips_by_asn</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;summarize_ips_by_asn&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>exclude_asns_from_summarization</strong> <a name="exclude_asns_from_summarization_flow"></a><br>
<font size="1"><a href="#flow_configurations">Back to flow configurations list</a></font></p>
<p>This configuration must be used in conjunction with <a href="#summarize_ips_by_asn_flow">summarize_ips_by_asn</a>, in order to exclude ASNs from summarization. In this case, packets transacted by excluded ASNs will be exposed by IPs.</p>
<p>The <code>exclude_asns_from_summarization</code> configuration usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="71:2"><input checked="checked" id="__tabbed_71_1" name="__tabbed_71" type="radio" /><input id="__tabbed_71_2" name="__tabbed_71" type="radio" /><div class="tabbed-labels"><label for="__tabbed_71_1">YAML</label><label for="__tabbed_71_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">exclude_asns_from_summarization</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8075</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16509</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;exclude_asns_from_summarization&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="mi">8075</span><span class="p">,</span>
<span class="w">    </span><span class="mi">16509</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>exclude_unknown_asns_from_summarization</strong> <a name="exclude_unknown_asns_from_summarization_flow"></a><br>
<font size="1"><a href="#flow_configurations">Back to flow configurations list</a></font></p>
<p>This configuration must be used in conjunction with <a href="#summarize_ips_by_asn_flow">summarize_ips_by_asn</a>, in order to expose IPs from packets transacted by unknown ASNs.</p>
<p>The <code>exclude_unknown_asns_from_summarization</code> configuration usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="72:2"><input checked="checked" id="__tabbed_72_1" name="__tabbed_72" type="radio" /><input id="__tabbed_72_2" name="__tabbed_72" type="radio" /><div class="tabbed-labels"><label for="__tabbed_72_1">YAML</label><label for="__tabbed_72_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">exclude_unknown_asns_from_summarization</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;exclude_unknown_asns_from_summarization&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>subnets_for_summarization</strong> <a name="subnets_for_summarization_flow"></a><br>
<font size="1"><a href="#flow_configurations">Back to flow configurations list</a></font></p>
<p>This configuration allows the summarization of flow data by subnets. Attention: This configuration will only work properly if the <a href="#summarize_ips_by_asn_flow">summarize_ips_by_asn</a> configuration is not set for the IP, since <a href="#summarize_ips_by_asn_flow">summarize_ips_by_asn</a> is dominant.</p>
<p>The <code>subnets_for_summarization</code> configuration usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="73:2"><input checked="checked" id="__tabbed_73_1" name="__tabbed_73" type="radio" /><input id="__tabbed_73_2" name="__tabbed_73" type="radio" /><div class="tabbed-labels"><label for="__tabbed_73_1">YAML</label><label for="__tabbed_73_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">subnets_for_summarization</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.2.1/24</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;subnets_for_summarization&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;192.168.2.1/24&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>It is possible to define a summary pattern by defining the CIDR only. In this way, all present IPs will be summarized. 
For this to be done, just pass the default host mask for IPv4 or/and IPv6 and the desired CIDR for grouping. 
This pattern has less priority than the explicitly defined subnets, so only IPs not belonging to any set subnet will be summarized following the general pattern.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="74:2"><input checked="checked" id="__tabbed_74_1" name="__tabbed_74" type="radio" /><input id="__tabbed_74_2" name="__tabbed_74" type="radio" /><div class="tabbed-labels"><label for="__tabbed_74_1">YAML</label><label for="__tabbed_74_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">subnets_for_summarization</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0/16</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">::/64</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;subnets_for_summarization&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;0.0.0.0/16&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;::/64&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<p><strong>exclude_ips_from_summarization_flow</strong> <a name="exclude_ips_from_summarization_flow"></a><br>
<font size="1"><a href="#flow_configurations">Back to flow configurations list</a></font></p>
<p>This configuration must be used in conjunction with <a href="#summarize_ips_by_asn_flow">summarize_ips_by_asn</a> or <a href="#subnets_for_summarization_flow">subnets_for_summarization</a> and will remove the specified IPs from the summarization.</p>
<p>The <code>exclude_ips_from_summarization_flow</code> configuration usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="75:2"><input checked="checked" id="__tabbed_75_1" name="__tabbed_75" type="radio" /><input id="__tabbed_75_2" name="__tabbed_75" type="radio" /><div class="tabbed-labels"><label for="__tabbed_75_1">YAML</label><label for="__tabbed_75_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">exclude_ips_from_summarization_flow</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">192.168.2.1/31</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;exclude_ips_from_summarization_flow&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;192.168.2.1/31&quot;</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><strong>recorded_stream</strong> <a name="recorded_stream_flow"></a><br>
<font size="1"><a href="#flow_configurations">Back to flow configurations list</a></font></p>
<p>This configuration is useful when a <a href="/documentation/orb_agent_configs/#pcap_file_input_pcap">pcap_file</a> is used in taps/input configuration. Set it to True when you want to load an offline traffic (from a pcap_file). <br></p>
<p>The <code>recorded_stream</code> configuration usage syntax is:<br></p>
<div class="tabbed-set tabbed-alternate" data-tabs="76:2"><input checked="checked" id="__tabbed_76_1" name="__tabbed_76" type="radio" /><input id="__tabbed_76_2" name="__tabbed_76" type="radio" /><div class="tabbed-labels"><label for="__tabbed_76_1">YAML</label><label for="__tabbed_76_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">recorded_stream</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;recorded_stream&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="netprobe-beta">Netprobe [BETA]</h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Status: <code>Beta</code>. The metric names and configuration options may still change</p>
</div>
<ul>
<li><a href="#NetprobePolicyExample">Example of policy</a></li>
<li><a href="#netprobe_metrics_group">Metrics Group</a></li>
<li><a href="#netprobe_filters">Filters</a></li>
<li><a href="#netprobe_configurations">Configurations</a></li>
</ul>
<h6 id="example-of-policy-with-input-netprobe-and-handler-netprobe">Example of policy with input netprobe and handler NETPROBE <a name="NetprobePolicyExample"></a></h6>
<div class="tabbed-set tabbed-alternate" data-tabs="77:2"><input checked="checked" id="__tabbed_77_1" name="__tabbed_77" type="radio" /><input id="__tabbed_77_2" name="__tabbed_77" type="radio" /><div class="tabbed-labels"><label for="__tabbed_77_1">YAML</label><label for="__tabbed_77_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">handlers</span><span class="p">:</span>
<span class="w">  </span><span class="nt">modules</span><span class="p">:</span>
<span class="w">    </span><span class="nt">default_netprobe</span><span class="p">:</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">netprobe</span>
<span class="w">      </span><span class="nt">metric_groups</span><span class="p">:</span>
<span class="w">        </span><span class="nt">enable</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">counters</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">quantiles</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">histograms</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">targets</span><span class="p">:</span>
<span class="w">          </span><span class="nt">www.google.com</span><span class="p">:</span>
<span class="w">            </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.google.com</span>
<span class="w">          </span><span class="nt">orb_community</span><span class="p">:</span>
<span class="w">            </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">orb.community</span>
<span class="nt">input</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">netprobe</span>
<span class="w">  </span><span class="nt">tap</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default_netprobe</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;default_netprobe&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;netprobe&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;metric_groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;counters&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;quantiles&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;histograms&quot;</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;www.google.com&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;www.google.com&quot;</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;orb_community&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;orb.community&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;netprobe&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;tap&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default_netprobe&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;collection&quot;</span>
<span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p><br></p>
<p><strong>Handler Type</strong>: "netprobe" <br></p>
<h4 id="metrics-group-check-the-netprobe-metrics-belonging-to-each-group">Metrics Group - <font size="1"><a href="/documentation/pktvisor_metrics/#netprobe-metrics-beta">Check the netprobe metrics belonging to each group</a></font><br> <a name="netprobe_metrics_group"></a></h4>
<table>
<thead>
<tr>
<th align="center">Metric Group</th>
<th align="center">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>quantiles</code></td>
<td align="center">disabled</td>
</tr>
<tr>
<td align="center"><code>counters</code></td>
<td align="center">enabled</td>
</tr>
<tr>
<td align="center"><code>histograms</code></td>
<td align="center">enabled</td>
</tr>
</tbody>
</table>
<h4 id="filters_8">Filters <a name="netprobe_filters"></a><br></h4>
<ul>
<li>No filters available. <br><br></li>
</ul>
<h4 id="configurations_6">Configurations <a name="netprobe_configurations"></a><br></h4>
<ul>
<li><a href="#abstract-configurations">Abstract configurations</a>. <br><br></li>
</ul>
<table>
<thead>
<tr>
<th align="center">Config</th>
<th align="center">Type</th>
<th align="center">Required</th>
<th align="center">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><a href="#targets_netprobe">targets</a></td>
<td align="center">map</td>
<td align="center">✅</td>
<td align="center">-</td>
</tr>
</tbody>
</table>
<p><strong>targets</strong>: <em>map</em> <a name="targets_netprobe"></a><br>
<font size="1"><a href="#netprobe_configurations">Back to netprobe configurations list</a></font></p>
<p>Here, the targets against which the probe will run are defined.
For each target is required to specify the target name and the address to be tested.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="78:1"><input checked="checked" id="__tabbed_78_1" name="__tabbed_78" type="radio" /><div class="tabbed-labels"><label for="__tabbed_78_1">YAML</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><div class="highlight"><pre><span></span><code><span class="nt">targets</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">map</span>
</code></pre></div>
Example:
<div class="highlight"><pre><span></span><code><span class="nt">targets</span><span class="p">:</span>
<span class="w">  </span><span class="nt">target_name</span><span class="p">:</span>
<span class="w">    </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ipv4 address to test</span>
</code></pre></div>
Generic Example:
<div class="highlight"><pre><span></span><code><span class="nt">targets</span><span class="p">:</span>
<span class="w">  </span><span class="nt">google</span><span class="p">:</span>
<span class="w">    </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.google.com</span>
</code></pre></div></p>
<ul>
<li>In netprobe policies it makes a lot of sense to use the settings from the input directly in the policy, since the settings are more related to the probe than the device the orb agent is running on. Therefore, it is worth reinforcing here the ability to override all tap settings in the policy. See <a href="/documentation/orb_agent_configs/#netprobe">here</a> the available configurations for netprobe.</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="79:2"><input checked="checked" id="__tabbed_79_1" name="__tabbed_79" type="radio" /><input id="__tabbed_79_2" name="__tabbed_79" type="radio" /><div class="tabbed-labels"><label for="__tabbed_79_1">YAML</label><label for="__tabbed_79_2">JSON</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">handlers</span><span class="p">:</span>
<span class="w">      </span><span class="nt">modules</span><span class="p">:</span>
<span class="w">        </span><span class="nt">default_netprobe</span><span class="p">:</span>
<span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">netprobe</span>
<span class="w">          </span><span class="nt">metric_groups</span><span class="p">:</span>
<span class="w">            </span><span class="nt">enable</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">counters</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">quantiles</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">histograms</span>
<span class="w">          </span><span class="nt">config</span><span class="p">:</span>
<span class="w">            </span><span class="nt">targets</span><span class="p">:</span>
<span class="w">              </span><span class="nt">www.google.com</span><span class="p">:</span>
<span class="w">                </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.google.com</span>
<span class="w">              </span><span class="nt">orb_community</span><span class="p">:</span>
<span class="w">                </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">orb.community</span>
<span class="w">    </span><span class="nt">input</span><span class="p">:</span>
<span class="w">      </span><span class="nt">input_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">netprobe</span>
<span class="w">      </span><span class="nt">tap</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default_netprobe</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">test_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ping</span>
<span class="w">        </span><span class="nt">interval_msec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2500</span>
<span class="w">        </span><span class="nt">timeout_msec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2000</span>
<span class="w">        </span><span class="nt">packets_per_test</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">        </span><span class="nt">packets_interval_msec</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<span class="w">        </span><span class="nt">packet_payload_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">56</span>
<span class="w">    </span><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">collection</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;handlers&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;modules&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;default_netprobe&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;netprobe&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;metric_groups&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;enable&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;counters&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;quantiles&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;histograms&quot;</span>
<span class="w">              </span><span class="p">]</span>
<span class="w">            </span><span class="p">},</span>
<span class="w">            </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;targets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nt">&quot;www.google.com&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;www.google.com&quot;</span>
<span class="w">                </span><span class="p">},</span>
<span class="w">                </span><span class="nt">&quot;orb_community&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;target&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;orb.community&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">              </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;input&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;input_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;netprobe&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;tap&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default_netprobe&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;test_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ping&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;interval_msec&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2500</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;timeout_msec&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2000</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;packets_per_test&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;packets_interval_msec&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;packet_payload_size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">56</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;collection&quot;</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>

              
            </article>
            
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../orb_agent_configs/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Configuring Orb Agent" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Configuring Orb Agent
            </div>
          </div>
        </a>
      
      
        
        <a href="../pktvisor_metrics/" class="md-footer__link md-footer__link--next" aria-label="Next: Orb Metrics" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Orb Metrics
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 | <a href="https://netboxlabs.com/privacy/">Privacy Policy</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/orb-community/orb" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://hub.docker.com/r/orbcommunity" target="_blank" rel="noopener" title="hub.docker.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://netdev.chat/" target="_blank" rel="noopener" title="netdev.chat" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
    </a>
  
    
    
    <a href="mailto:info@netboxlabs.com" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M1.75 3A1.75 1.75 0 0 0 0 4.75v14c0 .966.784 1.75 1.75 1.75h20.5A1.75 1.75 0 0 0 24 18.75v-14A1.75 1.75 0 0 0 22.25 3H1.75zM1.5 4.75a.25.25 0 0 1 .25-.25h20.5a.25.25 0 0 1 .25.25v.852l-10.36 7a.25.25 0 0 1-.28 0l-10.36-7V4.75zm0 2.662V18.75c0 .138.112.25.25.25h20.5a.25.25 0 0 0 .25-.25V7.412l-9.52 6.433c-.592.4-1.368.4-1.96 0L1.5 7.412z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tracking", "navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.indexes", "navigation.sections", "navigation.prune", "search.suggest"], "search": "../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../javascripts/tablesort.js"></script>
      
    
  </body>
</html>